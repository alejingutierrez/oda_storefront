# Redis/BullMQ
REDIS_URL=redis://default:<password>@<host>:<port>

# Admin auth (Bearer token)
ADMIN_TOKEN=replace_me

# Stable API URLs (preferir dominio canonical de prod)
CATALOG_WORKER_API_URL=https://oda-moda.vercel.app/api/admin/catalog-extractor/process-item
PRODUCT_ENRICHMENT_WORKER_API_URL=https://oda-moda.vercel.app/api/admin/product-enrichment/process-item
PLP_SEO_WORKER_API_URL=https://oda-moda.vercel.app/api/admin/plp-seo/process-item

# Concurrency
CATALOG_WORKER_CONCURRENCY=10
PRODUCT_ENRICHMENT_WORKER_CONCURRENCY=30
PLP_SEO_WORKER_CONCURRENCY=5

# Heartbeat (para que drains de Vercel hagan fallback solo si worker cae)
WORKER_HEARTBEAT_TTL_SECONDS=60
WORKER_HEARTBEAT_INTERVAL_MS=20000

# Autonomía (self-healing): si cola queda vacía con DB runnable, dispara drain automático.
WORKER_AUTONOMOUS_INTERVAL_MS=30000
WORKER_AUTONOMOUS_PROBE_TIMEOUT_MS=10000
WORKER_AUTONOMOUS_DRAIN_TIMEOUT_MS=60000
WORKER_AUTONOMOUS_CATALOG_LIMIT=8
WORKER_AUTONOMOUS_ENRICH_LIMIT=20
# Opcional: fijar endpoints explícitos (si no, se derivan desde *_WORKER_API_URL)
# WORKER_QUEUE_HEALTH_URL=https://oda-moda.vercel.app/api/admin/queue-health
# CATALOG_WORKER_DRAIN_URL=https://oda-moda.vercel.app/api/admin/catalog-extractor/drain
# PRODUCT_ENRICHMENT_WORKER_DRAIN_URL=https://oda-moda.vercel.app/api/admin/product-enrichment/drain

# API timeouts (ms). Usa 0 para desactivar abort desde cliente worker.
WORKER_FETCH_TIMEOUT_MS=0
# Opcional por cola (si no se definen, usan WORKER_FETCH_TIMEOUT_MS)
# CATALOG_WORKER_FETCH_TIMEOUT_MS=0
# PRODUCT_ENRICHMENT_WORKER_FETCH_TIMEOUT_MS=0
# PLP_SEO_WORKER_FETCH_TIMEOUT_MS=0

# Optional toggles
# CATALOG_WORKER_DISABLED=true
# PRODUCT_ENRICHMENT_WORKER_DISABLED=true
# PLP_SEO_WORKER_DISABLED=true
# WORKER_HEARTBEAT_DISABLED=true
# WORKER_AUTONOMOUS_DISABLED=true
