# STATUS (resumen operativo)

Usar este archivo para registrar, de forma breve, el estado global y los cierres de historias.

Formato sugerido:
- YYYY-MM-DD | MC-XXX | done | Resumen corto de lo entregado | Notas (build Vercel ok?/link, README actualizado, etc.)

Checklist obligatorio al cerrar una historia:
0) Pedir requisitos previos al solicitante (credenciales/API keys, definiciones faltantes, accesos).
1) Levantar servicios locales necesarios (web/scraper/worker) y revisar logs.
2) Push a la rama.
3) Esperar y revisar build en Vercel hasta que finalice correctamente.
4) Actualizar README con cambios relevantes.
5) Marcar la historia como terminada en `USER_STORIES.md`, `BACKLOG.md` y en este `STATUS.md`.

Registros:
- 2026-02-21 | MC-114 | fix | Auth Descope: `exchange` controlado + anti-loop de `next` en login OAuth | `apps/web/src/app/sign-in/SignInClient.tsx` vuelve a ejecutar `sdk.oauth.exchange(code)` cuando no hay sesi√≥n local (una sola vez por c√≥digo), manteniendo `E061301` como recoverable race sin UX de error (`console.debug` opcional + poll corto + cleanup URL). Se a√±ade sanitizaci√≥n centralizada de return paths en `apps/web/src/lib/auth-return.ts` para bloquear destinos `/sign-in`/`/auth/callback` y query params OAuth (`code`, `err`, `error`, `descope-login-flow`), integrada en `/sign-in`, `/auth/callback` y `ExperienceTracker` para evitar contaminaci√≥n de `oda_last_path` y loops `next=/sign-in?code=...`. Documentaci√≥n actualizada en `README.md`, `apps/web/README.md`, `USER_STORIES.md` y `BACKLOG.md`. Validaci√≥n: `npm -C apps/web run lint -- src/app/sign-in/SignInClient.tsx src/app/auth/callback/page.tsx src/app/ExperienceTracker.tsx src/lib/auth-return.ts` OK; `npm -C apps/web run build` OK (warning conocido `sslmode` de `pg`); smoke local Playwright con `?code=` y `next` inv√°lido limpia a `/sign-in` y no persiste `oda_last_path` auth. Push a `main`: commit `b1410c9`. Deploy prod Ready: `dpl_Eb4CmpCW1DBKQ3N6GUnxKTntQKTJ` (alias `https://oda-moda.vercel.app`). Runtime logs del deploy final: sin entradas de error en la ventana observada.
- 2026-02-21 | MC-114 | fix | Auth Descope: desbloqueo de `/sign-in` ante `E108202` (dominio no aprobado) + hardening de errores en UI | Se actualiz√≥ `trustedDomains` del proyecto Descope para incluir `oda-moda.vercel.app`, alias estable `git-main`, `localhost` y `127.0.0.1` (manteniendo `applyTrustedDomainsOnFlows=true`). En `apps/web/src/app/sign-in/SignInClient.tsx` se agreg√≥ parser robusto de errores (`CustomEvent.detail`) y mapeo expl√≠cito de `E108202` con mensaje accionable que incluye host actual; adem√°s se reforz√≥ logging estructurado (`hostname`, `flowId`, `projectId`, `errorCode`, `errorDescription`, `message`) sin cambiar contratos de `/auth/callback` ni `/api/user/*`. Documentaci√≥n operativa actualizada en `README.md` y `apps/web/README.md`; cierre de historia registrado en `USER_STORIES.md` y `BACKLOG.md`. Validaci√≥n: web local levantada (`next dev`), `npm -C apps/web run lint -- src/app/sign-in/SignInClient.tsx` OK, `npm -C apps/web run build` OK (warning conocido `sslmode` de `pg`), smoke Playwright en `https://oda-moda.vercel.app/sign-in` y `http://localhost:3000/sign-in` sin `E108202` en consola.
- 2026-02-20 | MC-135 | done | PLP: indicador/filtro de cambio de precio + filtro de ocasi√≥n | Se a√±adi√≥ se√±al persistida en `products` (`priceChangeDirection`, `priceChangeAt`) calculada por cambio de precio m√≠nimo visible (redondeo marketing), filtro backend `price_change=down|up` (ventana 30 d√≠as), chip `‚Üì/‚Üë` junto al precio en cards y filtro ‚ÄúOcasi√≥n‚Äù visible en desktop/mobile v√≠a `facets-lite.occasions`. Incluye migraci√≥n Prisma `20260220213000_add_product_price_change_signal`, √≠ndice parcial en `catalog-filter-indexes.sql`, script one-shot `backfill-product-price-change-signals.mjs` (ejecutado: `updatedProducts=13328`, `up=8368`, `down=4960`), noindex SEO para `price_change`, lint focalizado OK y `npm -C apps/web run build` OK. Push a `main`: commit `8992222`. Deploy prod Ready: `dpl_AhDhR148V4MkrJSr1iFtXthB8Bn6` (url `https://oda-storefront-6ee5-jx6k8bct3-alejingutierrezs-projects.vercel.app`, alias `https://oda-moda.vercel.app`). Build logs sin errores; runtime logs observados sin errores (eventos `status=200` en `edge-middleware` durante la ventana).
- 2026-02-20 | ops | fix | Home mobile: eliminaci√≥n de ‚Äúespacio vac√≠o/muerto‚Äù causado por `RevealOnScroll` en secciones altas | Root cause: el umbral `amount=0.24` en `src/components/home/RevealOnScroll.tsx` imped√≠a disparar `whileInView` en secciones muy altas en mobile (m√°x ratio de intersecci√≥n < 0.24), dejando bloques completos en `opacity:0`. Fix aplicado: `amount` default reducido a `0.01`. Validaci√≥n: lint puntual OK, `npm -C apps/web run build` OK, verificaci√≥n Playwright m√≥vil muestra secciones visibles y sin huecos ‚Äúmuertos‚Äù. Push a `main`: commit `896403f`. Deploy prod Ready: `dpl_AiAM7ZVtsccqX8G5xduYhxXS5Waf` (alias `https://oda-moda.vercel.app`). Runtime logs Vercel observados sin error para request de verificaci√≥n (`/api/admin/catalog-extractor/drain` status 200 en log edge-middleware).
- 2026-02-20 | MC-134 | done | Home inmersivo editorial (SSR + islas client) en `/` con hero full-bleed parallax, `RevealOnScroll`, carruseles swipe/drag (`Novedades`/`Trending`), `CategoryGallery` 3:4, `CuratedStickyEdit`, `ColorSwatchPalette`, `BrandMarquee`, y nuevo `HomeProductCard` vertical 3:4 sin romper `ProductCard` global | Implementado en `apps/web`: se agregaron `framer-motion` + `lucide-react`, nuevo m√≥dulo de tipos `src/lib/home-types.ts`, migraci√≥n de imports de tipos (`Header`, `MegaMenu`, `HeaderMobileMenu`, `ProductCard`) para desacoplar de `home-data` (`server-only`), y redise√±o completo de `src/app/page.tsx` manteniendo `getRotationSeed()`/`Promise.all`/`revalidate=3600` intactos. `globals.css` agrega utilidades `home-marquee-track`, `home-hide-scroll`, `home-drag-scroll`, `home-swatch-*` y bloque `@media (prefers-reduced-motion: reduce)` para degradaci√≥n elegante. Validaci√≥n local: `npm -C apps/web run lint -- <archivos tocados>` OK; `npm -C apps/web run build` OK (warning conocido `sslmode` de `pg`); servidor dev levantado en `localhost:3000` y smoke HTTP 200; QA Playwright: desktop/mobile render correcto, carrusel responde a bot√≥n/scroll (scrollLeft 0‚Üí928), mobile sin overflow horizontal (`390==390`) y reduced-motion desactiva marquee (`animationName=none`). Push a `main`: commit `405b63f`. Deploy prod Ready: `dpl_6HDkNXyMuuwNGprGFvbcEPThuzAD` (url `https://oda-storefront-6ee5-1e9hn8ewk-alejingutierrezs-projects.vercel.app`, alias `https://oda-moda.vercel.app`). Runtime logs Vercel revisados: sin errores, entradas `status=200` observadas.
- 2026-02-20 | MC-133 | done | PLP `/catalogo`: correcci√≥n de filtro de precios (histograma + UX + performance medible) | Implementado en `apps/web`: `catalog-data` ahora usa histograma orientado a producto (fast-path rollups + dedupe por `productId` por bin) y fast-path `price-only` para `products-count/counts/products-page/products` con intersecci√≥n de rangos sobre `minPriceCop/maxPriceCop`; `CatalogoFiltersPanel` a√±ade `externalPending`, `mode=full` bajo demanda real en Precio y tooltip edge-clamp en extremos; `CatalogMobileDock` agrega lock duro (`navigationPending` + watchdog), scrim/loading ‚ÄúAplicando filtros‚Ä¶‚Äù, bloqueo de `Filtrar/Ordenar/Limpiar/reapply`; `CatalogoClient` pasa `navigationPending` al dock; benchmark `scripts/benchmark-catalog-filters.mjs` renovado con fases `cold/warm`, escenarios `base|price_min_max|price_range` y secci√≥n SLO. Validaci√≥n local: `npm -C apps/web run lint -- <archivos tocados>` OK; `npx -C apps/web tsc --noEmit --project tsconfig.json` falla por error preexistente en `.next/dev/types/routes.d.ts`; smoke benchmark (`--limit 1 --no-price-sort`) ejecutado y reporte generado con resumen por endpoint/fase/escenario. Docs actualizadas: `README.md`, `BACKLOG.md`, `USER_STORIES.md`.
- 2026-02-20 | ops | fix | Hotfix producci√≥n `/admin/product-curation` 500 por desalineaci√≥n de migraciones Prisma | Se reconciliaron migraciones hist√≥ricas ya aplicadas en DB pero no marcadas en `_prisma_migrations` (`20260204193000_color_combinations_palette`, `20260212025000_taxonomy_remap_reviews`, `20260213150000_taxonomy_remap_auto_reseed_runs`, `20260218120000_plp_seo_pages`, `20260218201000_product_price_rollups`) usando `prisma migrate resolve --applied`; luego se aplic√≥ `20260220094000_product_curation_queue_and_editorial_flags` con `prisma migrate deploy`. Verificaci√≥n: `prisma migrate status` = up to date, columnas/tablas editoriales creadas, y endpoints prod `GET /api/admin/product-curation/products` + `GET /api/admin/product-curation/queue` respondiendo `200`. Push de trazabilidad: commit `da76dca`; deploy prod Ready `dpl_2zpR3e4uQrNF4ARR5GgmBw79vJhz` (alias `https://oda-moda.vercel.app`), build events sin errores (`errors=0`, `warnings=2` por advertencia conocida de versi√≥n de Node), runtime logs confirmando ambos endpoints de curaci√≥n en `status=200` sin 500.
- 2026-02-20 | MC-133 | done | Curaci√≥n programada + se√±ales editoriales (‚ù§Ô∏è/üëë) + sorts PLP | Implementado end-to-end: migraci√≥n Prisma (`products.editorial*`, `product_curation_queue_items`, `product_curation_apply_runs` + √≠ndices/constraint), motor √∫nico `src/lib/product-curation/apply-engine.ts`, refactor de `/api/admin/product-curation/bulk`, nuevos endpoints de cola (`GET/POST /queue`, `PATCH/DELETE /queue/[id]`, `POST /queue/apply`), redise√±o `/admin/product-curation` con composer + panel lateral `CurationQueuePanel`, bot√≥n global `Aplicar pendientes`, quick actions por card ‚ù§Ô∏è/üëë y chips editoriales en admin. Cat√°logo p√∫blico: nuevos sorts `top_picks` y `editorial_favorites` (toolbar/mobile/query). Validaci√≥n local: `npx prisma generate` OK; `npx eslint` en archivos tocados OK; `next build` OK cargando env desde `.env` (warning conocido `sslmode`). Push a `main`: commit `2dc1ad3`. Deploy prod Ready: https://oda-storefront-6ee5-ogjjevjsc-alejingutierrezs-projects.vercel.app (id `dpl_7bixk8UKnU7eHtjPKBs4MAqxc767`, alias activo `https://oda-moda.vercel.app`). Build events API: `errors=0`, `warnings=0` (178 eventos). Runtime logs (`vercel logs`, ventana de observaci√≥n 25s): sin eventos nuevos ni errores.
- 2026-02-19 | ops | fix | Worker truly aut√≥nomo: autopilot de auto-recuperaci√≥n cuando la cola queda vac√≠a o sin progreso | `services/worker/index.js` ahora incluye un bucle de health (`GET /api/admin/queue-health`) que detecta `queueEmptyButDbRunnable` y `staleNoProgress`, y dispara autom√°ticamente `POST /api/admin/catalog-extractor/drain` / `POST /api/admin/product-enrichment/drain` para destrabar corridas sin intervenci√≥n manual. Se agregaron env vars operativas en `services/worker/systemd/worker.env.example` (`WORKER_AUTONOMOUS_*`, `*_WORKER_DRAIN_URL`, `WORKER_QUEUE_HEALTH_URL`) y documentaci√≥n en README. Adem√°s, heartbeat ahora marca progreso cuando el autopilot drena (commit `7c0834f`) para que `queue-health` no aparezca sin actividad. Verificaci√≥n operativa: runnable cat√°logo en runs `processing` baj√≥ de `758` a `618` y runs `processing` bajaron de `19` a `8` durante la ventana de observaci√≥n; `GET /api/admin/queue-health` muestra `online=true`, `lastCompletedAt` reciente y ticks de auto-drain en curso.
- 2026-02-19 | ops | fix | Worker aut√≥nomo 24/7: fallback inteligente cuando no hay progreso real + control seguro de timeouts por cola | Hardening aplicado: `readHeartbeat` ahora incluye payload (`lastCompletedAt`) y los drains (`catalog-extractor`/`product-enrichment`) validan estado real de cola (`waiting+delayed` vs `active`) antes de hacer `skip`; si detectan `worker_stale_no_progress`, drenan autom√°ticamente sin `force`. Adem√°s, si Redis muestra cola vac√≠a pero DB conserva items runnable en runs `processing`, el drain fuerza recuperaci√≥n (`worker_queue_empty_db_runnable`). Se agreg√≥ visibilidad en `GET /api/admin/queue-health` con `workerStatus` (`backlog`, `active`, `staleNoProgress`, `lastCompletedAt`, `dbRunnable`, `queueEmptyButDbRunnable`). En worker Node se endureci√≥ operaci√≥n desatendida (logs de boot/ready/error/stalled + cierre fatal controlado para reinicio limpio por `systemd`) y se dej√≥ timeout HTTP configurable por cola, con opci√≥n de desactivar abort del cliente worker (`WORKER_FETCH_TIMEOUT_MS=0` recomendado + overrides `CATALOG_WORKER_FETCH_TIMEOUT_MS`, `PRODUCT_ENRICHMENT_WORKER_FETCH_TIMEOUT_MS`, `PLP_SEO_WORKER_FETCH_TIMEOUT_MS`). Push a `main`: commits `bd67899`, `a39e81a`, `d10dd20`. Deploy prod Ready: https://oda-moda.vercel.app (deployment `dpl_Bg4GBwkRMskkfrbwpnyFxYMBL6KR`), build events `errors=0`. Verificaci√≥n operativa: `/api/admin/queue-health` muestra `workerStatus.catalog.staleNoProgress=false`, `active=20` y backlog de `catalog` bajando a `0` durante la ventana de observaci√≥n.
- 2026-02-18 | MC-132 | fix | Mega menu: compactar espaciado desktop + remover desglose deportivo + ocultar subcategor√≠as vac√≠as | Implementado en `MegaMenu` y `HeaderMobileMenu`: l√≠neas m√°s compactas (`gap/py` reducidos) y render de subcategor√≠as solo con `count > 0`; en `getMegaMenuData` se removi√≥ el split especial de `ropa_deportiva_y_performance` y se subi√≥ `HOME_CACHE_VERSION` a `4` para invalidar cache. Validaci√≥n local: `cd apps/web && npx eslint src/components/Header.tsx src/components/MegaMenu.tsx src/components/HeaderMobileMenu.tsx` OK; `cd apps/web && npx tsc --noEmit --project tsconfig.json` OK. Push a `main`: commit `f5b85a2`. Deploy preview Ready: https://oda-storefront-6ee5-igs01k1m7-alejingutierrezs-projects.vercel.app (id `dpl_CgPeNdvr9RdTcp4YwRJg6VvS2T6V`), runtime logs sin eventos en la ventana observada (stream qued√≥ esperando tr√°fico nuevo).
- 2026-02-18 | MC-132 | done | Header + mega menu: fix ancho achatado y redise√±o UX desktop/mobile | Implementado: `Header` desktop en grid (`auto|minmax(0,1fr)|auto`) con buscador responsive `clamp`; `MegaMenu` convertido a interacci√≥n controlada por estado (hover temporal + pin por click, cierre por `Esc` y click fuera, panel √∫nico a ancho completo del container, scrim √∫nico, `aria-expanded/aria-controls`); `HeaderMobileMenu` migrado a drawer jer√°rquico (`root/gender/section`) con barra sticky, back contextual y cierre al navegar. Telemetr√≠a agregada con helper `src/lib/experience-events.ts`: `menu_open`, `menu_pin_toggle`, `menu_item_click`, `menu_mobile_step` hacia `/api/experience/events`. Validaci√≥n local: `npm -C apps/web run lint -- src/components/Header.tsx src/components/MegaMenu.tsx src/components/HeaderMobileMenu.tsx src/lib/experience-events.ts` OK; `cd apps/web && npx tsc --noEmit --project tsconfig.json` OK; build con env cargado desde `.env` v√≠a script seguro (`python3`) OK (`npm -C apps/web run build`), con warning conocido de `sslmode` de `pg`. Smoke Playwright (`next start` local): desktop 1024/1280/1366/1440/1728 con `panelWidth==containerWidth`; interacci√≥n pin/hover/outside/Esc OK; mobile drawer jer√°rquico + navegaci√≥n a `/buscar` cerrando overlay OK. Push a `main`: commit `0f47209`. Deploy prod Ready: https://oda-moda.vercel.app (deployment: https://oda-storefront-6ee5-o0flatbzw-alejingutierrezs-projects.vercel.app, id `dpl_A98H4GP8R9tj29US1yBSSYApVEXk`). Build events API: `errors=0`. Runtime logs (`vercel logs`, ventana ~20s): 258 entradas `info`, sin `warning/error`.
- 2026-02-18 | MC-131 | fix | PLP `/catalogo`: `price_asc/price_desc` sin timeout con rollups persistidos en `products` | Implementado: columnas `hasInStock/minPriceCop/maxPriceCop/priceRollupUpdatedAt` (Prisma + migraci√≥n `20260218201000_product_price_rollups`), script operacional `apps/web/scripts/backfill-product-price-rollups.mjs`, mantenimiento de rollups en `catalog/extractor` (con TRM de `pricing_config` y guardia `CATALOG_PRICE_MAX_VALID`), fast-path de queries en `catalog-data` para price sort y `price-bounds` (lite) sin filtros de variante, fallback a query pesado con `variants` cuando hay filtros de variante, √≠ndices concurrentes de soporte en `catalog-filter-indexes.sql` y benchmark defaults a `https://oda-moda.vercel.app`. Validaci√≥n local: `npx prisma generate` OK; `npx eslint` en archivos tocados OK (con override puntual de regla hist√≥rica `no-explicit-any` en `extractor.ts`); `npx tsc --noEmit --project tsconfig.json` mantiene fallo conocido en `.next/dev/types/validator.ts` (rutas admin). Deploy/push/backfill prod: pendiente en este corte.
- 2026-02-18 | MC-130 | done | Moneda por marca (USD) + TRM editable + redondeo marketing (xxxx0000) | Se agreg√≥ `/admin/pricing` con config global (TRM + umbrales) persistida en `standard_color_config:pricing_config`, auto-marcado de marcas USD (>75% muestra: variantes USD o COP<1999) con endpoints + cron Vercel diario, overrides por marca en `brands.metadata.pricing` (auto/manual), y serving de precios siempre en COP con conversi√≥n USD‚ÜíCOP (por TRM) y redondeo display a m√∫ltiplos de 10.000 COP. Push a `main`: commit `01c4f5c`. Deploy Vercel Ready: https://oda-moda.vercel.app (deployment: https://oda-storefront-6ee5-encbxc803-alejingutierrezs-projects.vercel.app, id `dpl_F9RHuxW88SPQcH3VBpBmkqFav258`).
- 2026-02-18 | MC-129 | done | PLP can√≥nicas SEO `/{genderSlug}/...` (sin `/g`) + facets-lite contextual (marcas por conteo desc), chips subcategor√≠a, contador real de marcas, patr√≥n/scroll filtros, toggle mobile por iconos y generador SEO PLP (Bedrock) en admin (`/admin/plp-seo`) con cola BullMQ + worker | Push a `main`: commit `f701243`. Deploy Vercel Ready: https://oda-storefront-6ee5-nicoqd8c8-alejingutierrezs-projects.vercel.app (id `dpl_FXEd9hRDauLRWmauD4PSLFzx1cVJ`). Docs actualizadas: README + USER_STORIES + BACKLOG.
- 2026-02-18 | ops | perf | Catalog-refresh throughput (semanal + Redis/BullMQ) | Implementado: scheduling semanal basado en `nextDueAt` con jitter, locks Redis por `runId` para evitar refills concurrentes, queries hot-path `exists` (findFirst) en vez de `count`, drains de Vercel como fallback (skip si worker online via heartbeat) y endpoint `GET /api/admin/queue-health`. Scripts operativos: `apps/web/scripts/reschedule-catalog-refresh-nextdue.mjs` (recalcula `nextDueAt`) y `apps/web/scripts/recover-bullmq-queues.mjs` (obliterate BullMQ + reset DB queued->pending + reseed). Cron `catalog-refresh/cron` ajustado a horario. Worker: heartbeats estables + templates `systemd`. Commits: `c6cab0e`, `01d5588`, `3392cda`.
- 2026-02-18 | MC-128 | done | PLP `/catalogo`: debounce filtros desktop (draft + auto-apply 400ms) + `/api/catalog/price-bounds` `mode=lite|full` (bounds r√°pido + full lazy) + √≠ndices GIN parciales para tags | Push a `main`: commit `c2e7673`. Deploy Vercel Ready: https://oda-storefront-6ee5-7hz3863q7-alejingutierrezs-projects.vercel.app (id `dpl_Hk4XDKfXV2yJGx71uKJaZjmCkmrj`). Smoke `curl`: `mode=lite` retorna `{ bounds, histogram:null, stats:null }`; `mode=full` retorna histogram/stats; ejemplo joyer√≠a: `lite.max=40000000`, `full.p98=18400000` (sin outliers >100M). Runtime logs (`vercel logs`): sin errores (solo info 200 en crons admin). Bench sample (`benchmark-catalog-filters.mjs --limit 8 --no-price-sort`): `price-bounds:lite p95=0.41s`, `price-bounds:full p95=1.25s`, `Over2s=[]`.
- 2026-02-17 | MC-125 | fix | PLP `/catalogo`: correcci√≥n de outliers de precio (rangos astron√≥micos) + saneamiento de ingesti√≥n | Se a√±adi√≥ guardia de precio v√°lido (`CATALOG_PRICE_MAX_VALID`, default 100M COP) en queries de cat√°logo (`price-bounds`, min/max por card y sort `price_asc/price_desc`) para ignorar variantes an√≥malas. `/api/catalog/price-bounds` vuelve a entregar `bounds + histogram + stats`. Ingesti√≥n endurecida: `catalog/extractor` y `catalog/normalizer` ahora descartan precios fuera de rango para evitar nuevos outliers persistidos. Validaci√≥n local: `npx eslint src/lib/catalog-price.ts src/lib/catalog-query.ts src/lib/catalog-data.ts src/app/api/catalog/price-bounds/route.ts` OK y `npx eslint src/lib/catalog/extractor.ts src/lib/catalog/normalizer.ts --rule '@typescript-eslint/no-explicit-any: off'` OK; `npx tsc --noEmit --project tsconfig.json` mantiene fallo conocido en `.next/dev/types/validator.ts` (rutas admin), y `npx next build` local falla por `Missing DATABASE_URL in environment` al recolectar page data. Push a `main`: commit `905e049` (+ docs/status `14bb5fe`). Deploy prod Ready: https://oda-moda.vercel.app (deployment: https://oda-storefront-6ee5-luazdoy9w-alejingutierrezs-projects.vercel.app, id `dpl_2zdDk4SnCSNsYNkC1WYbCodPo8cE`). Build events API: `errors=0`, `buildCompleted=true`. Smoke runtime (prod): `GET /catalogo` 200, `GET /api/catalog/price-bounds?category=joyeria_y_bisuteria` 200 con `max=18400000` (sin miles de millones), `GET /api/catalog/products?page=1&sort=price_desc&category=joyeria_y_bisuteria` 200 con tope de p√°gina `maxPrice=40000000` (sin outliers de 9+ d√≠gitos).
- 2026-02-17 | MC-125 | fix | PLP `/catalogo`: estabilizaci√≥n de filtro de precio desactivando prefetch en navegaci√≥n global | Diagn√≥stico: r√°fagas de prefetch `_rsc` desde header/mega menu compet√≠an con transiciones de filtros y dejaban estados ‚ÄúActualizando‚Ä¶‚Äù prolongados. Fix: `prefetch={false}` en links de `Header`, `HeaderMobileMenu` y `MegaMenu` para cortar saturaci√≥n de requests. Validaci√≥n local: `npx eslint src/components/Header.tsx src/components/MegaMenu.tsx src/components/HeaderMobileMenu.tsx` OK; `npx tsc --noEmit --project tsconfig.json` falla en tipos generados de `.next/dev/types/validator.ts` (no relacionado con este cambio). Push a `main`: commit `c7dfb6b`. Deploy prod Ready: https://oda-storefront-6ee5.vercel.app (deployment: https://oda-storefront-6ee5-fcgcws578-alejingutierrezs-projects.vercel.app, id `dpl_95vFRSSX4ZDQY9erPDDXBHC5PckQ`). Verificaci√≥n runtime logs Vercel: sin errores, solo `GET` 200 en jobs admin (`/api/admin/product-enrichment/drain`, `/api/admin/catalog-extractor/drain`).
- 2026-02-16 | MC-125 | fix | PLP `/catalogo`: hardening de filtros al volver de pesta√±a inactiva + estabilidad de infinite scroll (desktop/mobile) | Filtros: guardia anti-lock de transiciones (`useTransition`) con timeout + release en `focus/visibility/pageshow`, y eliminaci√≥n de `router.replace` no-op en panel y dock mobile. Infinite scroll: timeout/abort para `loadMore` y prefetch, recuperaci√≥n en `focus/online/pageshow`, fallback por proximidad real al sentinel y limpieza defensiva de loading en abort. Validaci√≥n local: `npx eslint src/components/CatalogoFiltersPanel.tsx src/components/CatalogMobileDock.tsx src/components/CatalogProductsInfinite.tsx src/app/catalogo/CatalogoClient.tsx` + `npx tsc --noEmit --pretty false` (en `apps/web`) OK. Deploy prod Ready: https://oda-storefront-6ee5.vercel.app (deployment: https://oda-storefront-6ee5-53rtyie8r-alejingutierrezs-projects.vercel.app, id `dpl_7rixCD3DpY4DguLZ55Tibtko4DAC`, commit `8f4c617`). Build events API: `errors=0` (`/v2/deployments/dpl_7rixCD3DpY4DguLZ55Tibtko4DAC/events`). Runtime logs Vercel: sin errores (solo info 200 en cron admin). QA Playwright CLI: desktop filtro `Femenino` + retorno de pesta√±a + `Masculino` aplicado (`?gender=Femenino&gender=Masculino`) y `Cargar m√°s` 24‚Üí48; auto-scroll 48‚Üí72. Mobile: dock `Filtrar` + `Aplicar` (`?gender=Femenino`) y carga 24‚Üí48 (auto)‚Üí72 (manual).
- 2026-02-16 | MC-115 | fix | Alineaci√≥n de universo entre `/catalogo` y `/admin/product-curation`: los endpoints admin `products/facets/ids` ahora fuerzan `inStock=true` junto con `enrichedOnly=true` | Diagn√≥stico previo (Neon): `admin=126126` vs `catalogo=98020` (`admin_not_catalog=28106`, todos fuera de stock). Verificaci√≥n posterior: `catalogo=98020` y `admin=98020` (diff=0) en DB y en prod v√≠a API (`/api/catalog/products-count` vs `/api/admin/product-curation/products?page=1&pageSize=1`). Validaci√≥n local: `npx eslint` (3 rutas) + `npx tsc --noEmit` OK. Deploy prod Ready: https://oda-storefront-6ee5.vercel.app (deployment: https://oda-storefront-6ee5-16nnqa7zr-alejingutierrezs-projects.vercel.app, id `dpl_8H9VNo2rrffdHU71HtwtxGR71Zf6`, commit `1d31e82`). Runtime smoke: `GET /catalogo` 200, `GET /api/catalog/products-count` 200, `GET /api/admin/product-curation/facets` 200, `GET /api/admin/product-curation/ids?limit=1` 200.
- 2026-02-16 | MC-115 | fix | Admin `/admin/product-curation`: mobile ahora muestra 2 cards por fila y cards compactas (menos detalle) para selecci√≥n m√°s r√°pida | Validaci√≥n local: `npx eslint src/app/admin/product-curation/ProductCurationPanel.tsx` + `npx tsc --noEmit --project tsconfig.json` (en `apps/web`) OK. Deploy prod Ready: https://oda-storefront-6ee5.vercel.app (deployment: https://oda-storefront-6ee5-g1sr6jiex-alejingutierrezs-projects.vercel.app, id `dpl_2ArzzxVPpMRz6VZ4d8ZbTN959VXk`, commit `f81aa0a`).
- 2026-02-16 | MC-120 | fix | Catalog-refresh: `new_products` enrichment ahora es configurable (auto-start opcional) + recuperaci√≥n de corridas legacy; Redis OOM resuelto limpiando colas BullMQ atascadas | Nuevo env: `CATALOG_REFRESH_ENRICH_AUTO_START` (prod=true, parse con `trim().toLowerCase()`). Redis Cloud estaba en `noeviction` y ~250MB con ~389k keys `bull:*`; se purgaron keys `bull:catalog:*` y `bull:product-enrichment:*` para liberar memoria (post: ~4MB, dbsize~17). Deploy prod Ready: https://oda-storefront-6ee5.vercel.app (deployment: https://oda-storefront-6ee5-dr50xssyl-alejingutierrezs-projects.vercel.app, id `dpl_CRaEPfPnHWTQiNzNB6qyDauFURSL`, commit `6b18dad`).
- 2026-02-15 | MC-127 | done | Admin `/admin/product-curation`: filtro por SEO tags (facet top 100 + query param `seo_tag`) para acelerar curaci√≥n | Validaci√≥n local: `npx eslint <archivos tocados>` + `npx tsc --noEmit --project tsconfig.json` (en `apps/web`) OK. Deploy prod Ready: https://oda-storefront-6ee5.vercel.app (deployment: https://oda-storefront-6ee5-dt6g7ygud-alejingutierrezs-projects.vercel.app, id `dpl_C8rztX4CWzUSm3WbZVttbUJv4kxd`, commit `6eb7b68`). Runtime logs: 200 en `/api/admin/catalog-extractor/drain`.
- 2026-02-15 | MC-125 | fix | PLP `/catalogo` (mobile): fix overflow por rail horizontal de subcategor√≠as + columnas al nivel del t√≠tulo + remover toggle de formato (siempre 3:4) + ToTop sin cruce con barra de subcategor√≠as; adem√°s se elimina hydration mismatch en header (React #418) | Validaci√≥n local: `npx eslint src/components/AccountLink.tsx` + `npx tsc --noEmit --project tsconfig.json` (en `apps/web`) OK. Deploy prod Ready: https://oda-storefront-6ee5.vercel.app (deployment: https://oda-storefront-6ee5-m43b9ibg8-alejingutierrezs-projects.vercel.app, id `dpl_6fYhyS5rRPxS6nAsbXwwyRWXRSsA`, commits `77fd5d7` + `eb46985`). Smoke Playwright: viewport 390px, overflow=0 y ToTop no interseca Subcategor√≠as.
- 2026-02-15 | MC-016 | done | PLP `/catalogo`: filtros <2s (p95 <0.40s en endpoints clave, Over2s=[]) + hardening UI de subcategor√≠as | DB (Neon): √≠ndices concurrentes para acelerar queries de cat√°logo (`products(category, createdAt)`, `products(category, subcategory, createdAt)` con enrichment+cover, `variants(productId)` instock y `variants(price)` instock+price). Scripts: `apps/web/scripts/catalog-filter-indexes.sql` + `apps/web/scripts/apply-catalog-filter-indexes.sh`. Bench reproducible: `apps/web/scripts/benchmark-catalog-filters.mjs` (y `apps/web/scripts/benchmark-catalog-filters.sh`). UI: ‚ÄúNo hay subcategor√≠as‚Ä¶‚Äù ahora espera 500ms antes de mostrarse (evita falso negativo transitorio). Deploy prod Ready: https://oda-storefront-6ee5.vercel.app (deployment: https://oda-storefront-6ee5-hq6prrfu8-alejingutierrezs-projects.vercel.app, id `dpl_ENhnTCmoJ24xVBkrgbgqP3uHNbHX`, commit `0d9927b`). Smoke: `/api/catalog/products-page`, `/api/catalog/subcategories`, `/api/catalog/price-bounds`, `/api/catalog/products-count` => 200.
- 2026-02-15 | MC-114 | fix | Auth usuarios (Descope): `/api/user/*` valida sesi√≥n con `Authorization: Bearer <sessionToken>` en cada handler (Descope `validateSession`), sin depender de cookie `DS`; middleware ya no protege `/api/user` ni `/perfil`; callback `/auth/callback` reintenta hasta tener token y sincroniza el usuario | Validaci√≥n local: eslint (archivos tocados) + `tsc --noEmit` OK. Deploy prod Ready: https://oda-storefront-6ee5.vercel.app (deployment: https://oda-storefront-6ee5-ohswsulv3-alejingutierrezs-projects.vercel.app, id `dpl_v5i43EbVu53F7moJDyVuuj7GA1qR`, commit `01c5830`). Smoke: `POST /api/user/sync` => 401 sin token, 200 con token v√°lido.
- 2026-02-15 | MC-114 | fix | Auth usuarios (Descope): login social m√°s confiable al iniciar OAuth desde `/sign-in` (evita popups bloqueados) usando `redirectUrl=<origin>/sign-in` en el componente Descope | Validaci√≥n local: `eslint` + `tsc --noEmit` OK. Deploy prod Ready: https://oda-storefront-6ee5.vercel.app (deployment: https://oda-storefront-6ee5-msxjiwwkn-alejingutierrezs-projects.vercel.app, id `dpl_Cj7RzPKEsHZHRsWTAv35rJVJpJFW`, commit `f18d5d2`). Smoke: Playwright click en ‚ÄúContinua con Google‚Äù navega a `accounts.google.com`.
- 2026-02-15 | MC-114 | fix | Auth usuarios (Descope): hardening del retorno OAuth en `/sign-in`: intercepta `?code=`/`?err=`, ejecuta `sdk.oauth.exchange(code)` expl√≠cito (1 sola vez) y ofrece ‚ÄúReintentar‚Äù limpiando la URL; mensaje espec√≠fico para `E061301` (c√≥digo expirado/usado) y `E062209` (setup OAuth) | Validaci√≥n local: `npx eslint src/app/sign-in/SignInClient.tsx` + `npx tsc --noEmit` OK. Deploy prod Ready: https://oda-storefront-6ee5.vercel.app (deployment: https://oda-storefront-6ee5-e03rdveq8-alejingutierrezs-projects.vercel.app, id `dpl_GC6U8rxzff385ZPhkNwEHvscsTKW`, commit `e6e96d9`). Smoke: Playwright `/sign-in?code=foo` muestra ‚ÄúReintentar‚Äù, `/sign-in?err=E062209` muestra error de setup y permite reintentar.
- 2026-02-15 | MC-126 | done | PLP `/catalogo`: polish desktop + listas + SEO + header | Desktop: card ‚ÄúFiltros‚Äù iguala altura con toolbar, columna filtros +20px, scroll por zonas (wheel izquierda => filtros), categor√≠as top 10 con ‚ÄúVer m√°s/menos‚Äù, toast 6s ‚ÄúAgregar a una lista‚Äù al dar fav + drawer de listas (crear+guardar), e indicador fijo ‚Äú% visto‚Äù sobre bot√≥n Arriba. SEO: `generateMetadata` + canonical y `noindex` defensivo en filtros profundos; `/buscar` canonical a `/catalogo`. Header: avatar sin texto, ‚ÄúIngresar‚Äù consistente, hover mejorado y glass en men√∫s. Validaci√≥n local: `npx eslint <archivos tocados>` + `npx tsc --noEmit` OK. Build local: no verificable en sandbox por DB (prerender `/` falla con `ECONNREFUSED`).
- 2026-02-14 | MC-114 | fix | Auth usuarios (Descope): login deja de rebotar a `/sign-in` por cookie de session no creado; ahora session token persiste en storage y refresh token va en cookie (para que `/perfil` pase middleware). Callback `/auth/callback` y llamadas a `/api/user/*` leen token robustamente (evita 401 falsos por race) | Validacion local: `eslint` + `tsc --noEmit` OK. Deploy: pendiente.
- 2026-02-14 | MC-125 | fix | PLP `/catalogo`: hardening al volver a pesta√±a (cache facets/subcats/precio), precio robusto (p02/p98 + histograma/presets), layout mobile (1:1/3:4 + ToTop arriba), header sin reacci√≥n al scroll + men√∫ mobile con scroll interno, sin cesta en cards, toolbar icon-only, enlaces de producto en nueva pesta√±a | Deploy prod Ready: https://oda-storefront-6ee5.vercel.app (deployment: https://oda-storefront-6ee5-980uh4xip-alejingutierrezs-projects.vercel.app, id `dpl_HtZpGVMPoqjqLprpEU7D4s19N99g`, commit `232787b`). Smoke: `GET /catalogo` 200, `GET /api/catalog/products?page=1` 200, `GET /api/catalog/price-bounds` 200.
- 2026-02-14 | MC-124 | fix | Taxonomy remap: hardening plural/singular (cacheteros‚Üíropa interior, montura‚Üímonturas) + nuevas regressions | Deploy prod Ready: https://oda-storefront-6ee5.vercel.app (deployment: https://oda-storefront-6ee5-nxw9yb8j4-alejingutierrezs-projects.vercel.app, commit `16467fc`). Auditor√≠a pending sample (200): suspiciousDenim=1 (solo flag de inspecci√≥n).
- 2026-02-14 | MC-124 | fix | Taxonomy remap: fixes espec√≠ficos (sets‚Üítops churn, charms‚Üícollares por ‚Äúcadena‚Äù, monturas‚Üígafas de sol por empate en ‚Äúgafas‚Äù, aretes con ‚Äúbotas/tenis‚Äù‚Üícalzado, ‚Äúculotte‚Äù underwear‚Üípantal√≥n) | `refresh_pending` aplicado; verificaci√≥n con casos reales (Paradizia/Citybags/Scalpers/Brezo/Laura) y auditor√≠a pending sample (200): suspicious=0.
- 2026-02-14 | MC-124 | fix | Taxonomy remap: hardening contra falsos positivos (ropa interior‚Üílencer√≠a, panty‚Üímedias lencer√≠a, ear cuff‚Üípiercings, short de ba√±o‚Üíshort casual algod√≥n, canguro/ri√±onera‚Üíhoodie) con nuevas se√±ales y gating en `signal-harvester` + `auto-reseed` | Auditor√≠a pending sample (200) post-refresh: nuevos suspicious=0; build local OK con Neon `DATABASE_URL`.
- 2026-02-14 | MC-124 | fix | Taxonomy remap: reducir falsos positivos (subcategor√≠as por anclas gen√©ricas), endurecer evidencia para cambios de subcategor√≠a, evitar churn de sportswear‚Üítops, y permitir `refresh_pending` sin cooldown | Deploy prod Ready: https://oda-storefront-6ee5.vercel.app (deployment: https://oda-storefront-6ee5-4ifpme476-alejingutierrezs-projects.vercel.app, commit `7b2bf7f`). Auditor√≠a pending sample (200): suspicious=0.
- 2026-02-14 | MC-125 | done | Cat√°logo p√∫blico: refinamientos PLP `/catalogo` (mobile + precio + cards) | Deploy prod Ready: https://oda-storefront-6ee5.vercel.app (deployment: https://oda-storefront-6ee5-nl5lwk1zl-alejingutierrezs-projects.vercel.app, id `dpl_DnVY2fEwkVTC4tyXrXm5UQjAotwt`, commit `a83394e`). Smoke: `GET /catalogo` 200, `GET /api/catalog/products?page=1` 200.
- 2026-02-13 | MC-124 | fix | Auto-reseed sin aprendizaje hist√≥rico + batch manual 10K estable | Se removi√≥ la fase de aprendizaje (`accepted/rejected`) del motor `auto-reseed` y ahora las propuestas se calculan con se√±ales directas del producto enriquecido (nombre/descripcion original/metadata/SEO). Se optimiz√≥ persistencia de propuestas por chunk con `deleteMany + createMany` (en vez de inserts fila a fila), se elev√≥ `maxDuration` a `300` en rutas de auto-reseed y accept/reject, y el front dej√≥ de mostrar m√©tricas de aprendizaje. El bot√≥n manual conserva `limit=10000`; ejecuciones no manuales usan l√≠mite conservador (2000) para evitar bloqueos, y `force` ahora puede recuperar corridas largas atascadas (`TAXONOMY_REMAP_AUTO_RESEED_FORCE_RECOVER_MINUTES`).
- 2026-02-13 | MC-124 | fix | Auto-reseed/remap hardening: aprendizaje m√°s limpio + feedback visual de ejecuci√≥n en `/admin/taxonomy-remap-review` | `auto-reseed` ahora aprende solo de decisiones con cambio real por campo (cat/subcat/g√©nero), excluye productos ya revisados para evitar repropuestas repetidas y registra corridas en tabla `taxonomy_remap_auto_reseed_runs` con lock persistente (√≠ndice √∫nico parcial `status='running'`). La UI muestra estado `en ejecuci√≥n`, run activo y √∫ltimo resultado de evaluaci√≥n (scanned/proposed/enqueued + muestras de aprendizaje). Migraci√≥n SQL aplicada en Neon (`20260213150000_taxonomy_remap_auto_reseed_runs`) y tabla verificada.
- 2026-02-13 | MC-124 | fix | Remap heur√≠sticas: suprimir `infantil` por color "beb√©/baby", reforzar `llavero‚Üídijes_charms` y "cuidado de cuero‚Üíhogar_otros", y permitir recalcular solo pendientes (`mode=refresh_pending`) | Deploy prod Ready: https://oda-storefront-6ee5.vercel.app (deployment: https://oda-storefront-6ee5-jf951p8d5-alejingutierrezs-projects.vercel.app, id `dpl_6bK9jrv4GBabj3haZTjGLgVFWqCV`). Auto-reseed manual `refresh_pending` ejecutado: runKey `20260213_221436` (scanned 3376, proposed 3183).
- 2026-02-12 | MC-124 | fix | Remapper reglas: `llavero/keychain` ‚Üí `joyeria_y_bisuteria/dijes_charms`, `cardholder/wallet` ‚Üí `bolsos_y_marroquineria/billetera`, care de cuero (grasa/bet√∫n/limpiador para cuero) ‚Üí `hogar_y_lifestyle/hogar_otros`, y override ‚ÄúCamisa‚Äù sobre buckets `blusa_*` (cuando el nombre lo indica) | Se evit√≥ doble conteo SEO (tag can√≥nico + lexical) cuando el can√≥nico ya existe para mejorar overrides de misclasificados anclados. Dry-run OK con 6 casos target y muestreo random 5k. Commit `db236ed`.
- 2026-02-12 | MC-124 | fix | Remap review: UX m√°s r√°pida (optimistic UI). Al aceptar/rechazar, la fila sale inmediatamente y se hace refresh silencioso con debounce para evitar el parpadeo de ‚ÄúCargando revisiones...‚Äù en cada decisi√≥n | Push `494e1e3`; Vercel deploy pendiente.
- 2026-02-12 | MC-124 | fix | UX de revisi√≥n remap sin fricci√≥n: acciones `Aceptar/Rechazar` ahora son inmediatas (sin prompt de motivo ni confirmaciones), y se a√±adi√≥ contador global de cat√°logo + contador de elegibles enriquecidos/faltantes en `/admin/taxonomy-remap-review` | API `GET /api/admin/taxonomy-remap/reviews` expone `catalog.totalProducts/reviewed/pending/remaining` y `catalog.eligible*`; validaci√≥n local eslint + tsc OK. Push `3a55b5a`; deploy prod Ready: https://oda-storefront-6ee5.vercel.app (deployment: https://oda-storefront-6ee5-r3txk0p61-alejingutierrezs-projects.vercel.app, id `dpl_7zWToERuYYXccYqHLQLuugExCKAa`). Verificaci√≥n runtime por curl: endpoint reviews 200 con nuevos campos de conteo.
- 2026-02-12 | MC-124 | done | Taxonomy remap: aprendizaje continuo + auto-reseed por umbral + contador de faltantes de fase | Se implement√≥ motor `auto-reseed` (`src/lib/taxonomy-remap/auto-reseed.ts`) que aprende de decisiones manuales (`accepted/rejected`) usando nombre/descripcion/descripcion original/SEO y propone remapeos para productos enriquecidos. Nuevo trigger autom√°tico cuando `pending <= 100` (configurable) con cooldown, endpoints `GET/POST /api/admin/taxonomy-remap/auto-reseed` y cron `GET/POST /api/admin/taxonomy-remap/auto-reseed/cron` (programado en `apps/web/vercel.json`). `GET /api/admin/taxonomy-remap/reviews` ahora retorna `phase` (faltantes, umbral, √∫ltimo auto-reseed), y el panel `/admin/taxonomy-remap-review` muestra contador y controles de ejecuci√≥n. Validaci√≥n local: eslint + `tsc --noEmit` OK. Pushes `60ae1d4` y fix `4b7d278`; deploy prod Ready: https://oda-storefront-6ee5.vercel.app (deployment final: https://oda-storefront-6ee5-6tyuocfu7-alejingutierrezs-projects.vercel.app, id `dpl_EajfEQHp4LGXbKJvaseeJYRnHXgq`). Verificaci√≥n runtime: `GET /api/admin/taxonomy-remap/reviews` 200 con `phase`, `POST /api/admin/taxonomy-remap/auto-reseed` 200 (`pending_above_threshold` cuando aplica), logs sin errores.
- 2026-02-12 | MC-123 | done | Cola y panel de revisi√≥n manual para remapeo taxon√≥mico (`/admin/taxonomy-remap-review`) con decisiones aceptar/rechazar y aplicaci√≥n controlada en `products` | Se agreg√≥ tabla `taxonomy_remap_reviews` (migraci√≥n `20260212025000_taxonomy_remap_reviews`), endpoints admin para listar/encolar/aceptar/rechazar propuestas, enlace en navegaci√≥n admin y soporte en script `remap-noncanonical-taxonomy` para encolar propuestas sin auto-aplicar (SEO-only queda manual). Validaci√≥n local: `eslint` (archivos tocados en `apps/web`), `tsc --noEmit` y `prisma validate` OK. Pushes `b74b1ee` + `54e56f9`; deploy prod Ready: https://oda-storefront-6ee5.vercel.app (deployment final: https://oda-storefront-6ee5-1ofpj0yg8-alejingutierrezs-projects.vercel.app, id `dpl_RBgjsMyhpkTKMJD9c3twzV3VMGLH`). Runtime verificado con `GET /api/admin/taxonomy-remap/reviews` 200 y logs de ejecuci√≥n sin errores.
- 2026-02-12 | MC-122 | done | Clasificador manual de categor√≠as/subcategor√≠as reforzado para enrichment (`signal-harvester`) | Se ampli√≥ `keyword-dictionaries.ts` con diccionarios por categor√≠a + reglas de subcategor√≠a para toda la taxonom√≠a publicada, expansi√≥n de sin√≥nimos ES/EN por frases/tokens y scoring por coincidencias (`scoreKeywordHits`) para que la inferencia no dependa del primer match. Se mantuvieron desambiguaciones cr√≠ticas (`collar`, `bota`, `body`). Validaci√≥n local: `npx eslint src/lib/product-enrichment/keyword-dictionaries.ts src/lib/product-enrichment/signal-harvester.ts` + `npx tsc --noEmit --project tsconfig.json` en `apps/web`. Push `8f2ab5f`; deploy prod Ready: https://oda-storefront-6ee5.vercel.app (deployment: https://oda-storefront-6ee5-4slzhwwvg-alejingutierrezs-projects.vercel.app, id `dpl_JAtDuMzAXJZYeW7ykXnv4HVK49f3`). Runtime logs verificados con 200 en `/api/admin/product-enrichment/state` y `/api/admin/product-enrichment/review-items`.
- 2026-02-11 | MC-121 | fix | Bedrock enrichment: fallback determin√≠stico de subcategor√≠a cuando el modelo devuelve valor fuera de taxonom√≠a (`Subcategory <x> does not belong to <category>`) | Se ajust√≥ `normalizeEnrichment` para intentar matching cercano dentro de subcategor√≠as permitidas por categor√≠a y fallback seguro al primer valor permitido si persiste ambig√ºedad. Commit `578f0d0`; deploy prod Ready: https://oda-storefront-6ee5.vercel.app (build URL: https://oda-storefront-6ee5-mov1r5vhi-alejingutierrezs-projects.vercel.app, id `dpl_GSeVSkMFXgYnQnFXXxSAcNGEaom5`). Verificaci√≥n `curl`: `POST /api/admin/product-enrichment/process-item` volvi√≥ a `status=completed` en corrida Bedrock (`runId=8b388472-90a7-4d1f-a65c-811b98c61a76`).
- 2026-02-11 | MC-121 | done | Product-enrichment con switch real OpenAI/Bedrock: Bedrock Haiku 4.5 activo para enrichment (`Converse` + tool-use), panel admin con visibilidad de proveedor/modelo y lote solicitado vs creado | Lint focalizado + `npx tsc --noEmit` + build local OK (`npm run build` con `DATABASE_URL`), smoke Bedrock OK (`npx tsx --tsconfig apps/web/tsconfig.json apps/web/scripts/test-bedrock-enrichment.ts` con `bedrock.test.success`). Push `b9f8163`. Deploy prod Ready/alias: https://oda-storefront-6ee5.vercel.app (deployment: https://oda-storefront-6ee5-j0dyqb93x-alejingutierrezs-projects.vercel.app, id `dpl_8548Z3eJGzFg7GqdTQJqJaJzsiMW`). Runtime logs verificados con `vercel logs` (200s en `/api/admin/product-enrichment/state` y `/review-items`). Curl post-deploy: `POST /api/admin/product-enrichment/run` devuelve `requestedItems/selectedItems`; `GET /api/admin/product-enrichment/state` muestra `provider=bedrock` y modelo Haiku 4.5; `POST /api/admin/product-enrichment/process-item` complet√≥ correctamente con Bedrock.
- 2026-02-11 | MC-120 | done | Catalog-refresh hardening: evitar auto-ejecuci√≥n de enrichment `new_products` | Se agreg√≥ guardia en `/api/admin/product-enrichment/drain` para pausar corridas `created_by=catalog_refresh` con `auto_start=false` (blockReason `auto_start_disabled`) y normalizaci√≥n adicional en `runCatalogRefreshBatch` para corridas heredadas en `processing`. Al reanudar manualmente con `POST /api/admin/product-enrichment/run` (`resume=true`), la metadata ahora marca `auto_start=true` + `manual_resume_at`. Lint + TypeScript OK. Push `fee803d`. Vercel prod Ready: https://oda-storefront-6ee5.vercel.app (deploy `dpl_7SsXZPwT2ouv5f6mfRq17sNzPJhb`, URL de build: https://oda-storefront-6ee5-kj31ywbf1-alejingutierrezs-projects.vercel.app). Verificaci√≥n DB/curl: antes `processing catalog_refresh auto_start=false = 84`; tras invocar cron (`/api/admin/catalog-refresh/cron?maxBrands=1&maxRuntimeMs=5000`) qued√≥ en `0`.
- 2026-02-11 | MC-119 | done | Product-enrichment: `Ejecutar batch/all` ahora crea run nuevo (fresh) y la reanudaci√≥n es expl√≠cita (`Reanudar corrida actual`); API `POST /api/admin/product-enrichment/run` asume `startFresh=true` por defecto cuando `resume=false` y no se env√≠a flag (compatibilidad clientes legacy) | Lint y TypeScript OK. Push `db4d315`. Vercel prod Ready: https://oda-storefront-6ee5.vercel.app (deploy `dpl_3JD78o4Vwch41YH5tmc6cuCKTgqZ`, URL de build: https://oda-storefront-6ee5-waoac895z-alejingutierrezs-projects.vercel.app). Verificaci√≥n curl en prod (marca `4724e517-2a5f-4729-a877-dae83d054af1`): `batch=10` => `total=10`; `all` => `total=229`; `pause` + `resume=true` mantiene mismo `runId` (`054a78f6-47d0-475d-ba0b-0a449a8cb082`).
- 2026-02-11 | MC-118 | done | Product-enrichment hardening: normalizaci√≥n defensiva de URLs de imagen antes de OpenAI (`//` y relativas), descarte de URLs inv√°lidas y nuevo endpoint `GET /api/admin/product-enrichment/review-items`; UI `/admin/product-enrichment` mejorada con tabla de revisi√≥n manual + baja confianza con razones y accesos directos | Lint y TypeScript OK. Verificaci√≥n curl en producci√≥n: antes del fix `process-item` devolv√≠a `400 Invalid image_url` para item `0f7e43c7-2537-4d11-8312-192ea26714d8`; tras deploy `2d23a7f` en Vercel (`https://oda-storefront-6ee5-93fjovdmk-alejingutierrezs-projects.vercel.app`, `dpl_7vAeBzFt2Tch31DBNvE82L8zkFLn`) el mismo `process-item` devuelve `{\"status\":\"completed\"}` y `state` queda con `lastError=null`.
- 2026-02-11 | MC-110 | fix | `/api/admin/catalog-refresh/cron` corrige parseo de query params opcionales: ya no convierte `null` a `0` (antes degradaba autom√°ticamente a `maxBrands=1`, `brandConcurrency=1`, `maxRuntimeMs=5000`), por lo que el cron sin params vuelve a respetar `CATALOG_REFRESH_*` de entorno | Build local OK con `DATABASE_URL` de prod env; validaci√≥n manual en prod del endpoint sin params: `processed=16`, `selected=16`, `brandConcurrency=6`; cron autom√°tico observado en ticks de 5 minutos.
- 2026-02-11 | MC-110 | ops | Perfil agresivo de `catalog-refresh` en prod: cron cada 5 min (`apps/web/vercel.json`), endpoint cron con `maxDuration=60`, y envs de producci√≥n ajustados (`CATALOG_REFRESH_INTERVAL_DAYS=1`, `CATALOG_REFRESH_JITTER_HOURS=2`, `CATALOG_REFRESH_MAX_BRANDS=16`, `CATALOG_REFRESH_BRAND_CONCURRENCY=6`, `CATALOG_REFRESH_MAX_RUNTIME_MS=55000`, `CATALOG_REFRESH_MIN_GAP_HOURS=1`, `CATALOG_REFRESH_COVERAGE_ENABLED=false`) | Vercel prod Ready: https://oda-storefront-6ee5.vercel.app (deploy `dpl_64r91Wwbikv4xw3nY5XA2vkEgeW9`).
- 2026-02-11 | MC-117 | done | Reingenier√≠a product-enrichment `v12.5`: se√±ales pre-LLM (nombre/descripcion original/vendor metadata), routing determin√≠stico a prompts por grupo, estrategia de im√°genes por categor√≠a, validador de consistencia con auto-fix, `confidence` local + `review_required`, preservaci√≥n de `original_description` y bloqueo por defecto de re-enrichment IA para productos ya enriquecidos | Lint OK (`npm run lint -- <archivos tocados>`), TypeScript OK (`npx tsc --noEmit`); build local falla al final por `Missing DATABASE_URL` en page-data collection. Push OK (`ac0ddfd`); Vercel prod Ready: https://oda-storefront-6ee5.vercel.app (deploy `dpl_AZuFm3CuSwsyTVnZX4suPogdT6G5`, runtime logs sin errores en ventana de revisi√≥n). README/BACKLOG/USER_STORIES actualizados.
- 2026-02-11 | MC-110 | fix | Refresh de cat√°logo m√°s r√°pido: procesamiento concurrente de marcas (`CATALOG_REFRESH_BRAND_CONCURRENCY`), opci√≥n de desactivar cobertura pesada (`CATALOG_REFRESH_COVERAGE_ENABLED`) y overrides runtime en `/api/admin/catalog-refresh/cron` (`maxBrands`, `brandConcurrency`, `maxRuntimeMs`) | Build local OK; push OK; Vercel prod Ready: https://oda-storefront-6ee5.vercel.app (deploy `dpl_2u3Nr5jie5zfP6L2qc8xmmTPc2MK`, commit `f2d81c0`).
- 2026-02-09 | ux | Curaci√≥n humana: redise√±o modal bulk edit (m√°s simple) con scope ‚ÄúFiltro actual‚Äù vs ‚ÄúSelecci√≥n‚Äù, y bot√≥n en header para bulk sin selecci√≥n manual | Push OK; Vercel prod Ready: https://oda-storefront-6ee5.vercel.app (deploy `dpl_8cVsfoD8T4pX5vA3k2yWvZWPsv3E`, commit `b2fad36`).
- 2026-02-09 | MC-115 | fix | Curaci√≥n humana: la modal de bulk edit ahora acota subcategor√≠as por contexto (filtro/selecci√≥n/cambio en modal) + endpoint `selection-summary` y preflight para evitar reemplazos inv√°lidos cuando la selecci√≥n mezcla categor√≠as | Push OK; Vercel prod Ready: https://oda-storefront-6ee5.vercel.app (deploy `dpl_2pf7tDUMrYctkiXDB95CkY9wawkv`, commit `c497578`).
- 2026-02-08 | MC-110 | fix | Catalog refresh hardening: normalizaci√≥n LLM con fallback (evita 429 quota como falla terminal), fallback de im√°genes (variant-only), m√©tricas de √©xito/fallos por run, umbral para no marcar marca como failed por pocos fallos, y productos nuevos se encolan para enrichment en `paused` (sin auto-ejecuci√≥n) + script `diagnose-catalog-refresh` | Push OK; Vercel prod Ready: https://oda-storefront-6ee5.vercel.app (deploy `dpl_FqQXo5rMDKYx1mpXeAwNvyaf8nLp`, commit `7bf3103`).
- 2026-02-08 | MC-116 | done | `/catalogo` oculta productos sin `metadata.enrichment` y evita 400 en im√°genes cuando el `src` pasa por `/api/image-proxy` (next/image `unoptimized`) + backfill de covers remotos a Blob | Push OK; Vercel prod Ready: https://oda-storefront-6ee5.vercel.app (deploy `dpl_FQMyRdxehn3xTPzeWSbwyyenGETP`, commit `9907f49`). Backfill covers enriched no-Blob: 9098 ‚Üí 1 (imagen demasiado grande para cachear).
- 2026-02-07 | ux | `/catalogo` rework: ‚ÄúOrdenar‚Äù como select √∫nico; filtros sticky con scroll interno; infinite scroll (lazy load) en lugar de paginaci√≥n; marcas sin l√≠mite + buscador; opciones con count=0 deshabilitadas y seleccionados arriba; colores estandarizados (chips por gama, sin hex); price range slider din√°mico; cat√°logo solo en stock; im√°genes optimizadas v√≠a `/api/image-proxy` + placeholders | Push OK; Vercel prod Ready: https://oda-storefront-6ee5.vercel.app (deploy `dpl_5JyFSGVzJB62JHVC6wbGvPApqbvK`, commit `7fe1ee2`).
- 2026-02-06 | fix | Perfil redise√±ado: `/perfil` comparte `Header`/mega menu; favoritos funcional (listar/quitar); listas funcionales (CRUD + items + ‚ÄúGuardar en lista‚Äù); bot√≥n "Guardar" en cards de `/catalogo`; rutas `/g/*` y `/buscar` existen (evita 404 de prefetch) | Push OK; Vercel prod Ready: https://oda-storefront-6ee5.vercel.app (deploy `dpl_5b1CPf2F3wpPUFGd2BW6qZWEvRuR`, commit `2615a9f`).
- 2026-02-06 | fix | Auth externo: callback robusto (no loops por 401 temprana), `/auth/callback` envia `Authorization: Bearer <sessionToken>` a `/api/user/sync` y las UIs (`/perfil`, favoritos) envian Bearer a `/api/user/*` | Push OK; Vercel prod Ready: https://oda-storefront-6ee5.vercel.app (deploy `dpl_5b1CPf2F3wpPUFGd2BW6qZWEvRuR`, commit `2615a9f`).
- 2026-02-06 | MC-009 | fix | Guardrails al publicar taxonom√≠a: evita romper dependencias (append-only de keys; categor√≠as requeridas activas; cada categor√≠a activa debe tener >=1 subcategor√≠a activa; bloquea publish si faltan style_tags activos; valida consistencia de subcategor√≠as duplicadas) | Vercel prod Ready: https://oda-storefront-6ee5.vercel.app (deploy dpl_CuxvQDboD9P8SYAu9Y4bsKeTEiY9). Smoke: `GET /api/admin/taxonomy/options` 200.
- 2026-02-06 | MC-009 | done | Taxonom√≠a editable (draft‚Üípublish) + editor admin `/admin/taxonomy` + endpoints (`/api/admin/taxonomy*`) + editor de `style_profiles` y backfill; consumo din√°mico en enrichment, facets y curaci√≥n humana | Vercel prod Ready: https://oda-storefront-6ee5.vercel.app (deploy dpl_BZDswfP2K8UHbaeHtR2M4s9Qqy9a). Smoke: `GET /api/admin/taxonomy?stage=draft` 200; `GET /api/admin/product-curation/products` 200.
- 2026-02-05 | MC-115 | fix | Bulk edit ahora permite m√∫ltiples cambios en la misma modal (varios campos a la vez) y el endpoint `/api/admin/product-curation/bulk` acepta `changes[]` en una sola transacci√≥n por producto | Vercel prod Ready: https://oda-storefront-6ee5-ibrrdyb0u-alejingutierrezs-projects.vercel.app
- 2026-02-05 | MC-115 | done | Curaci√≥n humana: `/admin/product-curation` con scroll infinito + selecci√≥n multi-producto + bulk edit de caracter√≠sticas (replace/add/remove/clear) con auditor√≠a `metadata.enrichment_human` sin tocar enrichment IA ni SEO/description | Build local OK; push OK; Vercel prod Ready: https://oda-storefront-6ee5-ekyemts65-alejingutierrezs-projects.vercel.app
- 2026-02-05 | fix | Auth externo: callback server-side + retorno a p√°gina original (SignInLink sin useSearchParams) | Vercel prod Ready: https://oda-storefront-6ee5-q9trvmilh-alejingutierrezs-projects.vercel.app
- 2026-02-05 | MC-114 | done | Auth usuarios externos con Descope + perfil + favoritos/listas + experience_events | Servicios locales no levantados; npm install @descope/nextjs-sdk se colg√≥ (package-lock sin actualizar); sin push ni verificaci√≥n de build/Vercel.
- 2026-02-05 | MC-113 | fix | Mega menu mantiene hover sobre panel | docker-compose no existe (repo des-dockerizado), por lo que no se pudo rebuild ni revisar logs locales; push OK; Vercel prod Ready: https://oda-storefront-6ee5-l7uvtcw76-alejingutierrezs-projects.vercel.app (runtime logs sin eventos durante observaci√≥n).
- 2026-02-05 | MC-113 | done | Ajustes home: ancho de layout, mega menu fijo/ancho, menu mobile, menos radio en fotos | docker-compose no existe (repo des-dockerizado), por lo que no se pudo rebuild ni revisar logs locales; push OK; Vercel prod Ready: https://oda-storefront-6ee5-gd0366d5c-alejingutierrezs-projects.vercel.app (runtime logs sin eventos durante observaci√≥n).
- 2026-02-04 | MC-113 | done | Home editorial + mega menu + rotaci√≥n 3 d√≠as | docker-compose no existe (repo des-dockerizado), por lo que no se pudo rebuild ni revisar logs locales; README/User Stories/Backlog actualizados; push OK; Vercel prod Ready: https://oda-storefront-6ee5-h5rmrt76g-alejingutierrezs-projects.vercel.app (runtime logs sin eventos durante observaci√≥n).
- 2026-02-04 | fix | Cobertura color-combinations ~98% | build-color-relations ahora mapea aliases y nombres de producto a standard colors + fallback de matches; rebuild completo de relaciones (variants 439,582 con match).
- 2026-02-04 | MC-112 | done | Des-dockerizar repo y docs | Dockerfiles/compose removidos; README/AGENTS/Backlog/User Stories actualizados; ejecuci√≥n local v√≠a npm; Vercel prod Ready: https://oda-storefront-6ee5-caz5rgigz-alejingutierrezs-projects.vercel.app.
- 2026-02-04 | MC-111 | done | Paleta 200 + matching estandarizado de combinaciones + admin actualizado | Docker build OK; web/worker healthy; scraper stub exit 0; `.dockerignore` agregado en `apps/web`; Vercel prod Ready: https://oda-storefront-6ee5-5e9idl2fk-alejingutierrezs-projects.vercel.app (runtime logs sin eventos en ventana corta).
- 2026-02-04 | MC-110 | done | Refresh semanal de cat√°logo + panel admin + cobertura/alertas + auto‚Äërecover + VTEX discovery completo | Docker rebuild omitido por solicitud; lint se colg√≥ y se abort√≥; pruebas VTEX via API (tennis/co.totto/mariohernandez/velez/studiof) muestran totales >1k; Vercel prod Ready: https://oda-storefront-6ee5-dt85iqjvh-alejingutierrezs-projects.vercel.app (runtime logs sin eventos durante la observaci√≥n).
- 2026-02-03 | deploy | Vercel prod Ready tras fix onboarding | https://oda-storefront-6ee5-d9zbsitfj-alejingutierrezs-projects.vercel.app
- 2026-02-03 | fix | Prisma JSON typing en onboarding | `OnboardingStepInfo.detail` ahora usa `Prisma.JsonValue` y persistencia serializa `onboarding` antes de guardar metadata.
- 2026-02-03 | fix | Vercel build: refreshOnboardingState before declaration | Ajustado orden de hooks en BrandDirectoryPanel para resolver TypeScript error de build.
- 2026-02-03 | MC-109 | done | Onboarding de marca desde modal (pipeline secuencial + progreso) | Docker rebuild omitido por solicitud; lint se colg√≥ y se detuvo; build local se qued√≥ en `prisma generate` y se detuvo; Vercel prod: deploy en Error `https://oda-storefront-6ee5-36esxrxdc-alejingutierrezs-projects.vercel.app` (inspect muestra dpl_D4giyXA4896pEheTo7B5hyP9xz17; CLI no devuelve logs porque est√° en Error); `vercel --prod` falla por `vercel.json` fuera de `apps/web` (rootDirectory).
- 2026-02-03 | MC-108 | done | Cola scraping marcas: encolar solo pendientes + drenar cola existente | Docker rebuild omitido por solicitud; smoke test DB OK (old eligible 440 vs new 6). Vercel prod Ready: https://oda-storefront-6ee5-i768gw7ga-alejingutierrezs-projects.vercel.app (runtime logs sin eventos durante la observaci√≥n).
- 2026-01-29 | MC-107 | done | Enrichment Bedrock estricto + repair/chunking + concurrency 40 | Docker rebuild ok; logs web/worker OK; scraper stub exit 0 (sitemap 404 esperado). Vercel prod Ready: https://oda-storefront-6ee5-1y1zlqmio-alejingutierrezs-projects.vercel.app (runtime logs sin eventos durante la revisi√≥n).
- 2026-01-29 | MC-106 | done | Estilos principal/secundario por styleTags | Docker rebuild ok; logs web/scraper OK; worker local con Redis OOM (maxmemory); migraci√≥n aplicada manualmente en Neon por lock de Prisma; Vercel prod Ready: https://oda-storefront-6ee5-ax65i39f0-alejingutierrezs-projects.vercel.app (runtime logs sin eventos durante observaci√≥n).
- 2026-01-29 | fix | Color combinations: filtro global por categorias permitidas | Docker rebuild ok; logs web/worker/scraper OK (warning sslmode).
- 2026-01-29 | MC-105 | done | Filtro por rol de color en combinaciones | Docker rebuild ok; logs web/worker/scraper OK (warning sslmode); Vercel preview Ready: https://oda-storefront-6ee5-ijobh21ni-alejingutierrezs-projects.vercel.app (runtime logs sin eventos).
- 2026-01-28 | fix | Bedrock AbortError: retry sin im√°genes + l√≠mite im√°genes | Docker rebuild ok; logs web/worker/scraper OK; Vercel prod Ready: https://oda-storefront-6ee5-plzxe6lv9-alejingutierrezs-projects.vercel.app (runtime logs sin eventos).
- 2026-01-28 | fix | Enrichment: quitar sesgo de category/subcategory + nueva taxonom√≠a (calzado/bolsos/gafas) | Docker rebuild ok; logs web/worker/scraper OK; Vercel prod Ready: https://oda-storefront-6ee5-lgivhj99i-alejingutierrezs-projects.vercel.app (runtime logs sin eventos).
- 2026-01-28 | fix | Enrichment: descripciones detalladas de categor√≠a/subcategor√≠a | Docker rebuild ok; logs web/worker/scraper OK; Vercel prod Ready: https://oda-storefront-6ee5-6ta234wdj-alejingutierrezs-projects.vercel.app (runtime logs sin eventos).
- 2026-01-28 | fix | Enrichment: timeout Bedrock para evitar timeouts en drain | Docker rebuild ok; logs web/worker/scraper OK; Vercel prod Ready: https://oda-storefront-6ee5-3qro7ms4r-alejingutierrezs-projects.vercel.app (runtime logs sin eventos).
- 2026-01-28 | fix | Enrichment: jsonrepair para JSON no estricto en Bedrock | Docker rebuild ok; logs web/worker/scraper OK; Vercel preview Ready: https://oda-storefront-6ee5-bh957xdwt-alejingutierrezs-projects.vercel.app (runtime logs sin eventos).
- 2026-01-28 | fix | Enrichment: description texto plano + Bedrock sin top_p | Docker rebuild ok; logs web/worker/scraper OK; Vercel preview Ready: https://oda-storefront-6ee5-8i5ltci85-alejingutierrezs-projects.vercel.app (runtime logs sin eventos).
- 2026-01-28 | fix | Enrichment: metales en materiales + JSON m√°s estricto | Docker rebuild ok; logs web/worker/scraper OK; Vercel preview Ready: https://oda-storefront-6ee5-g0ynnr056-alejingutierrezs-projects.vercel.app (runtime logs sin eventos).
- 2026-01-28 | fix | Enrichment: fallback para style_tags < 10 | Docker rebuild ok; logs web/worker/scraper OK; Vercel preview Ready: https://oda-storefront-6ee5-npf9jc723-alejingutierrezs-projects.vercel.app (runtime logs sin eventos).
- 2026-01-28 | fix | Bedrock enrichment: repair JSON + subcategory estricta | Docker rebuild ok; logs web/worker/scraper OK; Vercel preview Ready: https://oda-storefront-6ee5-oyfp0f61c-alejingutierrezs-projects.vercel.app (runtime logs sin eventos).
- 2026-01-28 | MC-104 | done | Enrichment productos con Claude Bedrock | Docker rebuild ok; logs web/worker/scraper OK; Vercel preview Ready: https://oda-storefront-6ee5-nucgmontm-alejingutierrezs-projects.vercel.app (runtime logs sin eventos); envs AWS/Bedrock creados en Vercel.
- 2026-01-28 | fix | Productos: filtro no fuerza brandId + prompt enrichment multicolor/unisex | Docker rebuild ok; logs web/worker/scraper OK; Vercel prod Ready: https://oda-storefront-6ee5-iwekfjqq9-alejingutierrezs-projects.vercel.app (runtime logs sin eventos durante la revisi√≥n).
- 2026-01-28 | fix | Enrichment: batch/queue floor a concurrencia efectiva | Docker rebuild ok; logs web/worker/scraper OK; Vercel prod Ready: https://oda-storefront-6ee5-6mix5s7ab-alejingutierrezs-projects.vercel.app (runtime logs sin eventos durante la revisi√≥n).
- 2026-01-28 | fix | Duplicar concurrencia product-enrichment a 20 | Drain y worker con clamp m√≠nimo 20; requiere redeploy worker/containers + Vercel.
- 2026-01-28 | fix | Concurrencia worker product-enrichment m√≠nimo 10 | Ajuste default + clamp en worker; requiere redeploy de worker/containers.
- 2026-01-28 | fix | Concurrencia m√≠nima 10 en drain de product-enrichment | Vercel prod Ready: https://oda-storefront-6ee5-m336ytr9u-alejingutierrezs-projects.vercel.app.
- 2026-01-28 | fix | Enrichment progreso sin pendientes fantasma | Docker rebuild ok; logs web/worker/scraper OK; Vercel prod Ready: https://oda-storefront-6ee5-zb7f46bpa-alejingutierrezs-projects.vercel.app (runtime logs sin eventos).
- 2026-01-28 | MC-103 | done | Campos SEO en productos + enrichment v4 | Docker rebuild ok; logs web/scraper OK; worker local 500 por migracion pendiente; migrate deploy a Neon fall√≥ (P1002 advisory lock). Vercel prod Ready: https://oda-storefront-6ee5-8iuwzeuqf-alejingutierrezs-projects.vercel.app (runtime logs sin eventos).
- 2026-01-28 | MC-102 | done | Enrichment panel: URL state + progreso realtime + reset batches | Docker rebuild ok; logs web/scraper OK; Vercel prod Ready: https://oda-storefront-6ee5-8iuwzeuqf-alejingutierrezs-projects.vercel.app (runtime logs sin eventos).
- 2026-01-28 | MC-101 | done | Default OpenAI gpt-5.1 en scrapers/normalizer y docs | Docker rebuild ok; logs web/worker/scraper OK; Vercel prod Ready: https://oda-storefront-6ee5-dtqz0z3yv-alejingutierrezs-projects.vercel.app (runtime logs sin eventos durante la revision).
- 2026-01-27 | fix | Modal producto cierra y limpia URL | Docker rebuild ok; logs web/worker/scraper OK; Vercel prod Ready: https://oda-storefront-6ee5-prwldiqf3-alejingutierrezs-projects.vercel.app (runtime logs sin eventos durante la revision).
- 2026-01-27 | fix | Batch de marcas sigue tras fallos | Docker rebuild ok; logs web/worker/scraper OK; Vercel prod Ready: https://oda-storefront-6ee5-pjddavzdl-alejingutierrezs-projects.vercel.app (runtime logs sin eventos durante la revision).
- 2026-01-27 | fix | Dropdown multi-select categorias en marcas | Docker rebuild ok; logs web/worker/scraper OK; Vercel prod Ready: https://oda-storefront-6ee5-500eckcsu-alejingutierrezs-projects.vercel.app (runtime logs sin eventos durante la revision).
- 2026-01-27 | fix | Image-proxy normaliza cdn-cgi | Docker rebuild ok; logs web/worker/scraper OK; Vercel prod Ready: https://oda-storefront-6ee5-9f47v2lqh-alejingutierrezs-projects.vercel.app (runtime logs sin eventos durante la revision).
- 2026-01-27 | fix | Imagenes proxy sin optimizacion Next | Docker rebuild ok; logs web/worker/scraper OK; Vercel prod Ready: https://oda-storefront-6ee5-cvb85mdh8-alejingutierrezs-projects.vercel.app (runtime logs sin eventos durante la revision).
- 2026-01-27 | fix | Next Image allowlist para Vercel Blob | Docker rebuild ok; logs web/worker/scraper OK; Vercel prod Ready: https://oda-storefront-6ee5-rekme1q93-alejingutierrezs-projects.vercel.app (runtime logs sin eventos durante la revision).
- 2026-01-27 | MC-100 | done | Filtro de categorias + orden por productos en /admin/brands | Docker rebuild ok; logs web/worker/scraper OK; Vercel prod Ready: https://oda-storefront-6ee5-dsuybazz1-alejingutierrezs-projects.vercel.app (runtime logs sin eventos durante la revision).
- 2026-01-27 | MC-099 | done | Contador pendientes marcas con desglose diagnostico | Docker rebuild ok; logs web/worker/scraper OK; Vercel prod Ready: https://oda-storefront-6ee5-y4ptk4uh7-alejingutierrezs-projects.vercel.app (runtime logs sin errores visibles durante la revision).
- 2026-01-27 | MC-098 | done | Proxy/cache de im√°genes para servir m√°s r√°pido desde Blob/CDN | Docker rebuild ok; logs web/scraper OK (worker con fallos Woo puntuales ya conocidos); Vercel prod Ready: https://oda-storefront-6ee5-7ut4mzww0-alejingutierrezs-projects.vercel.app (runtime logs sin errores visibles durante la revisi√≥n).
- 2026-01-27 | MC-097 | done | Persistencia de navegaci√≥n en admin (page/filter en URL) | Docker rebuild ok; logs web/scraper OK; worker sin OOM; vercel prod OK: https://oda-storefront-6ee5-158nqgnat-alejingutierrezs-projects.vercel.app (runtime logs sin eventos); delete A NEW CROSS verificado (brand no existe y 0 hu√©rfanos).
- 2026-01-27 | MC-096 | done | Modal marcas: stats reales + preview + delete cascada | Docker rebuild ok; logs web/scraper OK; worker Redis OOM mitigado limpiando ~40k keys `bull:*` y reiniciando worker; README/Backlog/User Stories actualizados.
- 2026-01-26 | MC-095 | done | UI: marcas sin run agrupadas por tecnolog√≠a + l√≠mite por plataforma 2000 | Docker rebuild ok; logs web/scraper OK; Redis OOM resuelto limpiando ~42k keys bull:* y reiniciando worker; Vercel prod OK: https://oda-storefront-6ee5-jexf1wgfl-alejingutierrezs-projects.vercel.app (logs sin eventos visibles).
- 2026-01-25 | MC-094 | done | Sitemap discovery tolerante a fallos (fetch failed) | Docker rebuild ok; logs web/worker/scraper OK; Vercel prod OK: https://oda-storefront-6ee5-5yjleqz98-alejingutierrezs-projects.vercel.app (deploy dpl_AxmzmhvWw2XoVDXrt373Ug1TTJmp, logs sin eventos en 1h).
- 2026-01-25 | MC-093 | done | Sitemap completo sin corte temprano + l√≠mite configurable | Docker rebuild ok; logs web/worker/scraper OK (warning sslmode); Vercel prod OK: https://oda-storefront-6ee5-4u1578k2v-alejingutierrezs-projects.vercel.app (deploy dpl_HPnN2t7fzRzhhLmD9L8zzr4iyS5n, logs sin eventos en 1h).
- 2026-01-25 | MC-092 | done | Reducir reintentos de cat√°logo | Docker rebuild ok; logs web/worker/scraper OK (warning sslmode); Vercel prod OK: https://oda-storefront-6ee5-4mpkvvs4o-alejingutierrezs-projects.vercel.app (deploy dpl_8BBkqXoW69RJHaJnwoCKeWPqV9bp, logs sin eventos).
- 2026-01-25 | MC-091 | done | Drain finaliza runs idle + control sitemap/queue | Docker rebuild ok; logs web/worker/scraper OK (warning sslmode); Vercel prod OK: https://oda-storefront-6ee5-izjoexjup-alejingutierrezs-projects.vercel.app (deploy dpl_GtGdfJ7TzEawz3WsWZb5KquMByQe, logs sin eventos).
- 2026-01-25 | MC-090 | done | Sitemap budget + precios Woo fallback | Docker rebuild ok; logs web/worker/scraper OK (warning sslmode); Vercel prod OK: https://oda-storefront-6ee5-b7n0zyw6g-alejingutierrezs-projects.vercel.app (deploy dpl_9m7ZAtqa9F2Uta9WvyNqftPV5LdN, logs sin eventos).
- 2026-01-25 | MC-084 | fix | Stop extractor ahora limpia jobs en cola y resetea items | Docker rebuild ok; docker-compose up ok; stop aplicado a 2 marcas activas (Bibiana Pineda Joyas, Love Culture).
- 2026-01-25 | MC-083 | fix | Coerce externalId/sku a string para evitar error Prisma en Woo | Docker rebuild ok; docker-compose up ok; logs saludables.
- 2026-01-25 | MC-089 | done | Concurrencia alta + progreso frecuente en extractor | Docker rebuild ok; logs web/worker/scraper OK; progreso usa runState live; Vercel prod OK: https://oda-storefront-6ee5.vercel.app (deploy dpl_CbZswEHcsuoEM5miLxhgGoMyzdo4).
- 2026-01-25 | MC-088 | done | Catalog extractor sin pausa por errores soft | Docker rebuild ok; logs web/worker/scraper OK; Vercel prod OK: https://oda-storefront-6ee5.vercel.app (deploy dpl_96jMabmxTGtcBx5qtU6iz7JnXmDA).
- 2026-01-25 | MC-087 | done | Modal productos + carrusel en cards | Docker rebuild ok; logs web/worker/scraper OK; Vercel prod OK: https://oda-storefront-6ee5.vercel.app (deploy dpl_8T6XGHVMRQ4qtHTfBdeC7RUcbmUG).
- 2026-01-25 | MC-085 | done | Style tags exactos 10 | Docker rebuild: ok; logs web/worker/scraper OK.
- 2026-01-25 | MC-084 | done | Auto‚Äërefresh enrichment solo con runs processing | Docker rebuild: ok; logs web/worker/scraper OK.
- 2026-01-25 | MC-083 | done | Estabilidad product‚Äëenrichment (drain cron + auto‚Äërefresh) | Docker rebuild: ok; Vercel prod OK: https://oda-storefront-6ee5.vercel.app; endpoint drain probado (200).
- 2026-01-25 | MC-082 | done | Normalizacion determinista v2 (reglas extendidas) | Docker rebuild ok; docker-compose up ok; logs web/worker/scraper saludables (warning sslmode); vercel build local OK; Vercel preview OK: https://oda-storefront-6ee5-git-mc-081-c37d8b-alejingutierrezs-projects.vercel.app
- 2026-01-25 | MC-081 | done | Catalog extractor: normalizacion determinista + menos OpenAI + retries cola | Docker rebuild: fallo (daemon apagado); vercel build local OK; Vercel preview OK: https://oda-storefront-6ee5-git-mc-081-c37d8b-alejingutierrezs-projects.vercel.app
- 2026-01-24 | MC-080 | done | Enriquecimiento IA de productos (admin + cola + GPT-5 mini) | Docker rebuild: fall√≥ (daemon apagado); migraci√≥n `20260124123000_product_enrichment` aplicada en Neon; Vercel prod OK: https://oda-storefront-6ee5.vercel.app; prueba batch 10 random OK (10/10).
- 2026-01-23 | MC-079 | fix | Auto‚ÄëPlay all no se detiene tras primera marca | Vercel prod OK: https://oda-storefront-6ee5-cnktphvd0-alejingutierrezs-projects.vercel.app
- 2026-01-23 | MC-078 | done | Bot√≥n Auto‚ÄëPlay para recorrer todas las marcas sin selecci√≥n manual | Vercel prod OK: https://oda-storefront-6ee5-e9bxrn5om-alejingutierrezs-projects.vercel.app
- 2026-01-23 | MC-077 | done | Auto-play selecciona marcas sin productos y encadena siguiente | Vercel prod OK: https://oda-storefront-6ee5-kvt8951mv-alejingutierrezs-projects.vercel.app
- 2026-01-23 | MC-076 | done | PDP LLM sin temperature en gpt-5 (evita 400) | Vercel prod OK: https://oda-storefront-6ee5-8tb3bbgn0-alejingutierrezs-projects.vercel.app
- 2026-01-23 | MC-075 | done | Errores no detienen extractor (sin auto‚Äëpause) + auto‚Äëresume continuo | Vercel prod OK: https://oda-storefront-6ee5-hnw0qqnzc-alejingutierrezs-projects.vercel.app (CATALOG_AUTO_PAUSE_ON_ERRORS=false).
- 2026-01-23 | MC-074 | done | Resume robusto (barrido + drain ilimitado por tiempo) y Blob path safe (#/?) | Vercel prod OK: https://oda-storefront-6ee5-54lb6safv-alejingutierrezs-projects.vercel.app (envs drain/resume actualizadas).
- 2026-01-23 | MC-073 | done | Drain serverless cat√°logo con cron Vercel | Build local OK (env); Vercel prod OK: https://oda-storefront-6ee5-8qznsuruv-alejingutierrezs-projects.vercel.app (logs sin eventos).
- 2026-01-23 | MC-072 | done | Redis + cola operativa en Vercel (guardas + timeout) | Docker rebuild: no ejecutado (daemon apagado); Vercel prod OK: https://oda-storefront-6ee5-65dxt41qs-alejingutierrezs-projects.vercel.app (logs sin eventos).
- 2026-01-23 | MC-071 | done | Blob robusto: sanitizar path + tolerar fallos parciales | Build local OK (env); Vercel prod OK: https://oda-storefront-6ee5-qiuv3hfhu-alejingutierrezs-projects.vercel.app (logs sin eventos).
- 2026-01-23 | MC-070 | done | Concurrencia cat√°logo v2 (cola + runs/items + backfill) | Build local OK (env); Vercel prod OK: https://oda-storefront-6ee5-qiuv3hfhu-alejingutierrezs-projects.vercel.app (logs sin eventos).
- 2026-01-23 | MC-069 | done | Telemetr√≠a de extractor + pausa por errores consecutivos | Docker rebuild: no requerido; build local OK (env); Vercel prod OK: https://oda-storefront-6ee5-htp4h72kw-alejingutierrezs-projects.vercel.app (logs sin eventos).
- 2026-01-23 | MC-068 | done | Resume UI + barrido de URLs + GPT-5 mini en productos | Docker rebuild: fall√≥ (daemon apagado); Vercel prod OK: https://oda-storefront-6ee5-d0jxgupfa-alejingutierrezs-projects.vercel.app (logs sin eventos).
- 2026-01-23 | MC-067 | done | Detener extractor conserva estado y permite reanudar | Docker rebuild: fall√≥ (daemon apagado); Vercel prod OK: https://oda-storefront-6ee5-78a47fh4x-alejingutierrezs-projects.vercel.app (logs sin eventos).
- 2026-01-23 | MC-066 | done | Catalog extractor: finalizar marca y sacarla de la cola | Docker rebuild: ok; servicios locales OK; Vercel pendiente (sin acceso).
- 2026-01-23 | MC-065 | done | LLM PDP fallback + limpieza de marcas | Docker rebuild: ok; servicios locales OK; Vercel pendiente.
- 2026-01-22 | MC-064 | done | Normaliza ImageObject antes de subir a Blob | Docker rebuild: ok; Vercel prod OK: https://oda-storefront-6ee5-l2c89z1w0-alejingutierrezs-projects.vercel.app (logs sin eventos).
- 2026-01-22 | MC-063 | done | Blob retry con referer/UA | Docker rebuild: ok; Vercel prod OK: https://oda-storefront-6ee5-bcdhvfxlm-alejingutierrezs-projects.vercel.app (logs sin eventos).
- 2026-01-22 | MC-062 | done | Custom: omite sitemap sin PDPs + excluye /portafolio | Docker rebuild: fall√≥ (daemon apagado); Vercel prod OK: https://oda-storefront-6ee5.vercel.app (alias).
- 2026-01-22 | MC-061 | done | Unknown: sitemaps extra + inferencia r√°pida plataforma sin LLM | Docker rebuild: fall√≥ (daemon apagado); pruebas r√°pidas con tsx no ejecutables por alias `@/` fuera de tsconfig; Vercel prod OK: https://oda-storefront-6ee5-bv62sxd1m-alejingutierrezs-projects.vercel.app (logs sin eventos).
- 2026-01-22 | MC-060 | done | Custom adapter filtra listados por og:type/rutas | Docker rebuild: fall√≥ (daemon apagado); pruebas unknown con PDPs OK (Derek, Lyenzo, Zuahaza); Vercel prod OK: https://oda-storefront-6ee5-38wsp1vwl-alejingutierrezs-projects.vercel.app.
- 2026-01-22 | MC-059 | done | Custom adapter evita listados y acepta pistas de PDP sin JSON-LD | Docker rebuild: fall√≥ (daemon apagado); ejecuci√≥n batch tech profiler completada; Vercel prod OK: https://oda-storefront-6ee5-inhkc67k2-alejingutierrezs-projects.vercel.app (logs sin eventos).
- 2026-01-22 | MC-058 | done | Mejoras unknown: tech profiler Tiendanube/Wix + parked/unreachable + patrones de producto | Docker rebuild: fall√≥ (daemon apagado); Vercel prod OK: https://oda-storefront-6ee5-eh4orhbg9-alejingutierrezs-projects.vercel.app (logs sin eventos).
- 2026-01-22 | MC-057 | done | Marca manualReview cuando no hay productos detectables | Docker rebuild: fall√≥ (daemon apagado); Vercel prod OK: https://oda-storefront-6ee5-836cmfy95-alejingutierrezs-projects.vercel.app
- 2026-01-22 | MC-056 | done | Filtra URLs de sitemap por mismo dominio | Docker rebuild: fall√≥ (daemon apagado); Vercel prod OK: https://oda-storefront-6ee5-7xssnhjib-alejingutierrezs-projects.vercel.app
- 2026-01-22 | MC-055 | done | Fallback a API cuando sitemap no trae productos (evita URLs no-producto en VTEX) | Docker rebuild: fall√≥ (daemon apagado); Vercel prod OK: https://oda-storefront-6ee5-iq7spmpy5-alejingutierrezs-projects.vercel.app
- 2026-01-21 | MC-054 | done | Sitemap discovery full (index/gz) + fallback HTML Woo/VTEX + smoke test por tecnolog√≠a | Docker rebuild: fall√≥ (daemon apagado); Vercel prod OK: https://oda-storefront-6ee5-ppznfqdln-alejingutierrezs-projects.vercel.app (logs sin eventos en tail).
- 2026-01-21 | MC-053 | done | VTEX: linkText desde URL en sitemap + error con plataforma/URL | Docker rebuild: fall√≥ (daemon apagado); Vercel prod OK: https://oda-storefront-6ee5-9pube0ap3-alejingutierrezs-projects.vercel.app
- 2026-01-21 | MC-052 | done | Panel catalog extractor ahora muestra errores y bloqueos | Docker rebuild: fall√≥ (daemon apagado); Vercel prod OK: https://oda-storefront-6ee5-6o0cbizja-alejingutierrezs-projects.vercel.app
- 2026-01-21 | MC-051 | done | Catalog extractor por tecnologia: play/pausa/detener, auto‚Äëavance y sitemap‚Äëfirst con reanudaci√≥n | Docker rebuild: fall√≥ (daemon apagado); Vercel prod OK: https://oda-storefront-6ee5-dfx8rvjsp-alejingutierrezs-projects.vercel.app
- 2026-01-21 | MC-050 | done | Tech profiler sanitiza Unicode y parseo JSON tolerante para evitar 500 por escapes inv√°lidos | Docker rebuild: fall√≥ (daemon apagado); Vercel prod OK: https://oda-storefront-6ee5-8nelw4f1b-alejingutierrezs-projects.vercel.app
- 2026-01-21 | MC-049 | done | Default OpenAI vuelve a gpt-5.2 en scrapers/normalizer y docs | Docker rebuild: fall√≥ (daemon apagado); Vercel prod OK: https://oda-storefront-6ee5-pz7sc4d9s-alejingutierrezs-projects.vercel.app
- 2026-01-21 | MC-048 | done | Limpieza de evidencia: HTML‚Üítexto, filtrado de l√≠neas y priorizaci√≥n por se√±ales relevantes para OpenAI | Docker rebuild: fall√≥ (daemon apagado); Vercel prod OK: https://oda-storefront-6ee5-ilgipaww5-alejingutierrezs-projects.vercel.app
- 2026-01-20 | MC-047 | done | Cambia modelo OpenAI por defecto a gpt-5-mini para scrapers | Docker rebuild: fall√≥ (daemon apagado); Vercel prod OK: https://oda-storefront-6ee5.vercel.app
- 2026-01-20 | MC-046 | done | Reglas de moneda (USD/COP), parseo de precios, currency en productos + reset cat√°logo (truncate products/variants) | Docker rebuild: fall√≥ (daemon apagado); Vercel prod OK: https://oda-storefront-6ee5.vercel.app
- 2026-01-20 | MC-045 | done | Progreso extractor productos (barra informativa + reanudaci√≥n por tandas + fix OpenAI wrapper) | Docker rebuild: fall√≥ (daemon apagado); Vercel prod OK: https://oda-storefront-6ee5.vercel.app
- 2026-01-20 | MC-044 | done | Directorio admin de productos (cards + modal, filtro por marca, endpoints /api/admin/products) | Docker rebuild: fall√≥ (daemon apagado); Vercel prod OK: https://oda-storefront-6ee5.vercel.app
- 2026-01-20 | MC-043 | done | Catalog extractor por tecnolog√≠a (Shopify/Woo/Magento/VTEX/Custom) con panel `/admin/catalog-extractor`, normalizaci√≥n OpenAI y subida a Blob | Docker rebuild: fall√≥ (daemon apagado); Vercel prod OK: https://oda-storefront-6ee5.vercel.app
- 2026-01-20 | MC-042 | done | Revisi√≥n manual de marcas (check azul en cards + toggle en modal, persistido en DB) | Docker rebuild: fall√≥ (daemon apagado); Vercel prod OK: https://oda-storefront-6ee5.vercel.app
- 2026-01-20 | MC-041 | done | Tech profiler de marcas (campo ecommercePlatform, panel /admin/brands/tech, API tech profiler) | Docker rebuild: fall√≥ (daemon apagado); Vercel prod OK: https://oda-storefront-6ee5.vercel.app
- 2026-01-20 | MC-040 | done | Re‚Äëenriquecer por marca (m√©todo 2: 14 fuentes, 20k chars) + mini progreso en card | Docker rebuild: fall√≥ (daemon apagado); Vercel prod OK: https://oda-storefront-6ee5.vercel.app
- 2026-01-20 | MC-039 | done | Cards muestran logo cuando existe y URLs clicables en modal de marca | Docker rebuild: fall√≥ (daemon apagado); Vercel prod OK: https://oda-storefront-6ee5.vercel.app
- 2026-01-20 | MC-038 | done | Admin con sidebar anclado a la izquierda para ganar espacio de canvas | Docker rebuild: fall√≥ (daemon apagado); Vercel prod OK: https://oda-storefront-6ee5.vercel.app
- 2026-01-20 | MC-037 | done | Resiliencia scraping admin: re‚Äëencola jobs atascados, auto‚Äëresume tras recarga, /admin/brands separado de /admin/brands/scrape y men√∫ lateral | Docker rebuild: fall√≥ (daemon apagado); Vercel prod OK: https://oda-storefront-6ee5.vercel.app
- 2026-01-20 | MC-036 | done | Directorio admin de marcas con cards 3x5, modal de detalle, CRUD y filtros/paginaci√≥n; API CRUD brands | Docker rebuild: fall√≥ (daemon apagado); Vercel prod OK: https://oda-storefront-6ee5.vercel.app
- 2026-01-19 | MC-035 | fix | Ajusta bot√≥n "Encolar y ejecutar": ahora procesa solo la cantidad encolada (evita drenar cola completa) | Docker rebuild: TLS handshake timeout con docker.io; Vercel prod OK: https://oda-storefront-6ee5-jpvx4krxz-alejingutierrezs-projects.vercel.app
- 2026-01-19 | MC-035 | fix | Ajusta web_search: query √∫nica con instagram, tool config CO/high y alerta si <10 fuentes | Docker rebuild: error Docker API 500; Vercel prod OK: https://oda-storefront-6ee5-8er10tg0o-alejingutierrezs-projects.vercel.app
- 2026-01-19 | MC-035 | fix | Sanitiza texto para evitar Unicode inv√°lido en metadata (surrogates/control chars) | Docker rebuild ok; Vercel prod OK: https://oda-storefront-6ee5-435cz194p-alejingutierrezs-projects.vercel.app
- 2026-01-19 | MC-035 | fix | Coerci√≥n de sources.other a strings (url/title) para evitar fallos de validaci√≥n OpenAI | Docker rebuild ok; Vercel prod OK: https://oda-storefront-6ee5-gnw7hyy47-alejingutierrezs-projects.vercel.app
- 2026-01-19 | MC-035 | fix | Normaliza payload OpenAI: coerce para opening_hours (string‚Üíobj/null), sources.website (array‚Üístring), y lat/lng desde string | Docker rebuild ok; Vercel prod OK: https://oda-storefront-6ee5-iqrt6ftb5-alejingutierrezs-projects.vercel.app
- 2026-01-19 | MC-035 | fix | Aumenta evidencia a 10k caracteres por fuente en enrichment de marcas | Docker rebuild ok; Vercel prod OK: https://oda-storefront-6ee5-g11gbakrb-alejingutierrezs-projects.vercel.app
- 2026-01-19 | MC-035 | fix | Evidencia web m√≠nima 7 fuentes: fetch HTML de fuentes, extracci√≥n de texto/t√≠tulo, se pasa como evidence_texts a OpenAI y se guarda en metadata | Docker rebuild ok; Vercel prod OK: https://oda-storefront-6ee5-a1v57ppob-alejingutierrezs-projects.vercel.app
- 2026-01-19 | MC-035 | fix | Mejora UI de diff en admin: muestra solo campos cambiados con antes/despu√©s legible | Docker rebuild ok; Vercel prod OK: https://oda-storefront-6ee5-97sbtpmql-alejingutierrezs-projects.vercel.app
- 2026-01-19 | MC-035 | fix | Mejora calidad de datos de marcas: se agregan se√±ales multi‚Äëp√°gina (contacto/ubicaci√≥n), parsing de JSON-LD @graph/sameAs, extracci√≥n de lat/lng en mapas/meta/data, prompt con evidencia y fallback a valores existentes | Docker rebuild ok; Vercel prod OK: https://oda-storefront-6ee5-qbk546zju-alejingutierrezs-projects.vercel.app
- 2026-01-19 | MC-035 | fix | Corrige 500 en `/api/admin/brands` por conteos BigInt (casts a int en summary) | Docker rebuild ok; Vercel prod OK: https://oda-storefront-6ee5-kctrrzw34-alejingutierrezs-projects.vercel.app
- 2026-01-19 | MC-035 | done | Scraper de marcas con cola (1/5/10/25/50), panel /admin/brands, endpoints admin + cron, tabla completa de marcas con diff antes/despu√©s y enriquecimiento OpenAI web search + fallback HTML, tabla brand_scrape_jobs | Docker rebuild ok; Vercel prod OK: https://oda-storefront-6ee5-juzgjesbw-alejingutierrezs-projects.vercel.app
- 2026-01-19 | MC-006 | done | Login admin (email/password + cookie), seed admin en Neon, /admin directo, middleware s√≥lo en /api/normalize; carga Excel a columnas (incluye ratings) | Docker rebuild ok; Vercel prod OK: https://oda-storefront-6ee5-8wm8f249r-alejingutierrezs-projects.vercel.app
- 2026-01-19 | meta | done | Sync repo con origin, fixes build Vercel (OpenAI lazy client + Node 22), docker compose healthy (web/worker/db/redis) | Vercel preview OK: https://oda-storefront-6ee5-o4pjm62bz-alejingutierrezs-projects.vercel.app
- 2026-01-15 | MC-001 | done | Estructura base repo (Next TS/Tailwind), servicios scraper/worker stub, docker-compose, .env.example, README inicial; envs creadas en Vercel (prod/preview/dev) | Build local ok (lint/build); Vercel deploy productivo OK (https://oda-storefront-6ee5-hdg0yo8xc-alejingutierrezs-projects.vercel.app); stack docker corriendo en host puerto 3080.
- 2026-01-15 | meta | done | Limpieza de variables duplicadas en Vercel (prefijo `oda_*` removido) y carga de credenciales Neon/Blob finales | Env set consolidado; pendiente acceso del autor correcto para deploy.
- 2026-01-15 | meta | done | Deploy Vercel producci√≥n OK | https://oda-storefront-6ee5-hdg0yo8xc-alejingutierrezs-projects.vercel.app
- 2026-01-15 | MC-002 | done | Docker compose local con web/scraper/worker, Postgres pgvector, Redis; healthchecks y puerto 3080 para web; envs alineadas con Vercel | `docker-compose up -d` exitoso; warning de NODE_ENV en Next pendiente de afinado pero servicio operativo.
- 2026-01-15 | MC-003 | done | Esquema inicial + migraci√≥n Prisma (brands, stores, products, variants, price/stock history, assets polim√≥rficos, taxonomy_tags, users, events, announcements) con pgvector | Migraci√≥n `20260115125012_init_schema` aplicada en DB local (pgvector habilitado); Prisma client generado.
- 2026-01-15 | MC-004 | done | Cliente OpenAI GPT-5.2 con retries y validaci√≥n Zod; endpoint `/api/normalize`; middleware Bearer (ADMIN_TOKEN/NEXTAUTH_SECRET) protegiendo admin/API; README actualizado; build y lint ok | Deploy Vercel incluye /admin y /api/normalize.
- 2026-01-25 | MC-086 | done | Progreso incremental product-enrichment (no drain en run) | Docker rebuild ok; servicios healthy; Vercel prod OK: https://oda-storefront-6ee5-qe83zgip0-alejingutierrezs-projects.vercel.app (runtime logs sin eventos).
